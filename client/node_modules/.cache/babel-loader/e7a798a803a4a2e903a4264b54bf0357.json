{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./List.css';import*as display from'../../services/display/display';import*as edit from'../../services/edit/edit';import*as util from'../../services/util/util';import TaskList from'../TaskList/TaskList';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var List=/*#__PURE__*/function(_React$Component){_inherits(List,_React$Component);var _super=_createSuper(List);function List(props){var _this;_classCallCheck(this,List);_this=_super.call(this,props);_this.updateHeights=function(){return;if(!_this.taskList.current)return;var objects=_this.taskList.current.subtaskObjects.filter(function(x){return x.current.isComplete()!=='complete';});for(var i=0;i<objects.length-1;i++){var thisObject=objects[i].current;var nextObject=objects[i+1].current;var minHeight=1;if(thisObject.state.info.type==='event'){var endDate=thisObject.state.info.endDate;if(!endDate.includes('--')){// rounded to 30 minutes\nminHeight=(endDate[0]*60+endDate[1])/60;}else if(nextObject.state.info.type==='event'){// no end date\nvar startDate=nextObject.state.info.startDate;if(!startDate.includes('--')){var difference=util.getTime(startDate)-util.getTime(thisObject.state.info.startDate);minHeight=difference/60;}}}thisObject.setState({minHeight:minHeight});}if(objects.length>0){var _minHeight=1;var lastObject=objects[objects.length-1].current;var _endDate=lastObject.state.info.endDate;if(lastObject.state.info.type==='event'&&!_endDate.includes('--')){// rounded to 30 minutes\n_minHeight=(_endDate[0]*60+_endDate[1])/60;}lastObject.setState({minHeight:_minHeight});}};_this.taskList=/*#__PURE__*/React.createRef();_this.state={// filter subtasks here\nsubtasks:props.subtasks,title:props.title,info:{},zoomed:''};return _this;}_createClass(List,[{key:\"changeTitle\",value:function changeTitle(ev){this.setState({title:ev.target.value});}},{key:\"sortList\",value:function sortList(){// sort the given list by time\nvar ordered=true;var currentTime=0;var _iterator=_createForOfIteratorHelper(this.subtasksCurrent),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var x=_step.value;var task=window.data.tasks[util.stripR(x)];var thisTime=util.getTime(task.info.startDate);if(task.info.type==='event'&&thisTime<currentTime){ordered=false;break;}currentTime=thisTime;}}catch(err){_iterator.e(err);}finally{_iterator.f();}if(ordered)return;// sort the list\nvar sortedList=[];var currentSort=['start'];var _iterator2=_createForOfIteratorHelper(this.subtasksCurrent),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _task=_step2.value;var taskData=window.data.tasks[util.stripR(_task)];if(taskData.info.type==='event'&&!taskData.info.startDate.includes('--')){sortedList.push(currentSort);currentSort=[];currentSort.push(_task);}else{currentSort.push(_task);}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}sortedList.push(currentSort);// add last thing\nsortedList=sortedList.sort(function(a,b){if(a[0]==='start'||a.length===0){a=a.splice(0,1);return-1;}else if(b[0]==='start'||b.length===0){b=b.splice(0,1);return 1;}else{return util.getTime(window.data.tasks[util.stripR(a[0])].info.startDate)-util.getTime(window.data.tasks[util.stripR(b[0])].info.startDate);}}).flat();this.subtasksCurrent=sortedList;}},{key:\"render\",value:function render(){var _this2=this;var selectThis=function selectThis(){edit.selectTask(_this2);};this.changeTitle=this.changeTitle.bind(this);this.listInput=/*#__PURE__*/React.createRef();this.subtasksCurrent=this.state.subtasks.filter(function(x){return!(x.charAt(0)==='R'&&!_this2.props.repeats.includes(x))&&window.data.tasks[util.stripR(x)];});if(this.props.parent.props.id==='river'){var _iterator3=_createForOfIteratorHelper(this.props.repeats),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var task=_step3.value;if(!this.subtasksCurrent.includes(task)&&!this.subtasksCurrent.includes(util.stripR(task))){this.subtasksCurrent.push(task);}}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}if(util.getFrame(this).props.id==='river'){this.sortList();setTimeout(this.updateHeights,100);}return/*#__PURE__*/_jsxs(\"div\",{className:'list '+this.state.zoomed,onClick:selectThis,onContextMenu:selectThis,children:[/*#__PURE__*/_jsx(\"div\",{className:\"listInputBackground\",children:this.props.parent.props.id==='bank'?/*#__PURE__*/_jsx(\"input\",{className:\"listInput\",value:this.state.title,onChange:this.changeTitle,ref:this.listInput}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"monthYear\",children:[/*#__PURE__*/_jsx(\"span\",{children:this.state.title.slice(4,8)}),/*#__PURE__*/_jsx(\"span\",{children:this.state.title.slice(11)})]}),/*#__PURE__*/_jsx(\"input\",{readOnly:true,className:\"listInput listTitle\",value:util.dateFormat(this.state.title),ref:this.listInput})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"listFrame\",children:[this.props.parent.props.id==='river'&&this.props.deadlines&&/*#__PURE__*/_jsx(\"ul\",{children:this.props.deadlines.map(function(x){return/*#__PURE__*/_jsx(\"li\",{className:\"deadline\",onClick:function onClick(){return display.searchDate(window.data.tasks[util.stripR(x)].title,'start');},children:window.data.tasks[util.stripR(x)].title},String(x));})}),this.props.parent.props.id==='river'&&this.props.startdates&&/*#__PURE__*/_jsx(\"ul\",{children:this.props.startdates.map(function(x){return/*#__PURE__*/_jsx(\"li\",{className:\"startdate\",onClick:function onClick(){return display.searchDate(window.data.tasks[util.stripR(x)].title,'start');},children:window.data.tasks[util.stripR(x)].title},String(x));})}),/*#__PURE__*/_jsx(TaskList,{ref:this.taskList,subtasks:this.subtasksCurrent,parent:this})]})]});}}]);return List;}(React.Component);export{List as default};","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/components/List/List.js"],"names":["React","display","edit","util","TaskList","List","props","updateHeights","taskList","current","objects","subtaskObjects","filter","x","isComplete","i","length","thisObject","nextObject","minHeight","state","info","type","endDate","includes","startDate","difference","getTime","setState","lastObject","createRef","subtasks","title","zoomed","ev","target","value","ordered","currentTime","subtasksCurrent","task","window","data","tasks","stripR","thisTime","sortedList","currentSort","taskData","push","sort","a","b","splice","flat","selectThis","selectTask","changeTitle","bind","listInput","charAt","repeats","parent","id","getFrame","sortList","setTimeout","slice","dateFormat","deadlines","map","searchDate","String","startdates","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './List.css';\nimport * as display from '../../services/display/display';\nimport * as edit from '../../services/edit/edit';\nimport * as util from '../../services/util/util';\nimport TaskList from '../TaskList/TaskList';\n\nexport default class List extends React.Component {\n  constructor(props) {\n    super(props);\n    this.taskList = React.createRef();\n    this.state = {\n      // filter subtasks here\n      subtasks: props.subtasks,\n      title: props.title,\n      info: {}, zoomed: ''\n    };\n  }\n  changeTitle(ev) {\n    this.setState({ title: ev.target.value });\n  }\n  sortList() {\n    // sort the given list by time\n    let ordered = true;\n    let currentTime = 0;\n    for (let x of this.subtasksCurrent) {\n      const task = window.data.tasks[util.stripR(x)];\n      const thisTime = util.getTime(task.info.startDate);\n      if (\n        task.info.type === 'event' &&\n        thisTime < currentTime\n      ) {\n        ordered = false;\n        break;\n      }\n      currentTime = thisTime;\n    }\n    if (ordered) return;\n    // sort the list\n    let sortedList = [];\n    let currentSort = ['start'];\n    for (let task of this.subtasksCurrent) {\n      const taskData = window.data.tasks[util.stripR(task)];\n      if (taskData.info.type === 'event' && \n        !taskData.info.startDate.includes('--')) {\n        sortedList.push(currentSort);\n        currentSort = [];\n        currentSort.push(task);\n      } else {\n        currentSort.push(task);\n      }\n    }\n    sortedList.push(currentSort); // add last thing\n    sortedList = sortedList.sort((a, b) => {\n      if (a[0] === 'start' || a.length === 0) {\n        a = a.splice(0, 1);\n        return -1;\n      } else if (b[0] === 'start' || b.length === 0) {\n        b = b.splice(0, 1);\n        return 1;\n      } else {\n        return util.getTime(window.data.tasks[util.stripR(a[0])].info.startDate) - \n          util.getTime(window.data.tasks[util.stripR(b[0])].info.startDate)\n      }\n    }).flat();\n    this.subtasksCurrent = sortedList;\n  }\n  updateHeights = () => {\n    return\n    if (!this.taskList.current) return;\n    const objects = this.taskList.current.subtaskObjects.filter(\n      x => x.current.isComplete() !== 'complete'\n    );\n    for (\n      let i = 0; i < objects.length - 1; i++\n    ) {\n      const thisObject = objects[i].current;\n      const nextObject = objects[i + 1].current;\n      let minHeight = 1;\n      if (\n        thisObject.state.info.type === 'event'\n      ) {\n        const endDate = thisObject.state.info.endDate;\n        if (!endDate.includes('--')) {\n          // rounded to 30 minutes\n          minHeight = (endDate[0] * 60 + endDate[1]) / 60;\n        } else if (nextObject.state.info.type === 'event') {\n          // no end date\n          const startDate = nextObject.state.info.startDate;\n          if (!startDate.includes('--')) {\n            const difference = \n              util.getTime(startDate) - util.getTime(thisObject.state.info.startDate);\n            minHeight = difference / 60;\n          }\n        }\n      }\n      thisObject.setState({ minHeight: minHeight });\n    }\n    if (objects.length > 0) {\n      let minHeight = 1;\n      const lastObject = objects[objects.length - 1].current;\n      const endDate = lastObject.state.info.endDate;\n      if (lastObject.state.info.type === 'event' &&\n        !endDate.includes('--')) {\n        // rounded to 30 minutes\n        minHeight = (endDate[0] * 60 + endDate[1]) / 60;\n      }\n      lastObject.setState({ minHeight: minHeight });\n    }\n  }\n  render() {\n    var selectThis = () => {\n      edit.selectTask(this);\n    }\n    this.changeTitle = this.changeTitle.bind(this);\n    this.listInput = React.createRef();\n    this.subtasksCurrent = this.state.subtasks.filter(x =>\n      !(x.charAt(0) === 'R' && !this.props.repeats.includes(x)) &&\n      window.data.tasks[util.stripR(x)]);\n    if (this.props.parent.props.id === 'river') {\n      for (let task of this.props.repeats) {\n        if (!this.subtasksCurrent.includes(task) &&\n          !this.subtasksCurrent.includes(util.stripR(task))) {\n          this.subtasksCurrent.push(task);\n        }\n      }\n    }\n    if (util.getFrame(this).props.id === 'river') {\n      this.sortList();\n      setTimeout(this.updateHeights, 100);\n    }\n    return (\n      <div className={'list ' + this.state.zoomed} onClick={selectThis}\n        onContextMenu={selectThis}>\n        <div className='listInputBackground'>\n          {this.props.parent.props.id === 'bank' ?\n            <input className='listInput' value={this.state.title}\n              onChange={this.changeTitle} ref={this.listInput}></input> :\n            <>\n              <div className='monthYear'>\n                <span>{this.state.title.slice(4, 8)}</span>\n                <span>{this.state.title.slice(11)}</span>\n              </div>\n              <input readOnly className='listInput listTitle'\n                value={util.dateFormat(this.state.title)} ref={this.listInput}>\n              </input>\n            </>\n          }\n        </div>\n        <div className='listFrame'>\n          {this.props.parent.props.id === 'river' &&\n            this.props.deadlines &&\n            <ul>\n              {this.props.deadlines.map(x => {\n                return <li\n                  className='deadline' key={String(x)}\n                  onClick={() => display.searchDate(window.data.tasks[util.stripR(x)].title, 'start')}>\n                  {window.data.tasks[util.stripR(x)].title}</li>;\n              })}\n            </ul>}\n          {this.props.parent.props.id === 'river' &&\n            this.props.startdates &&\n            <ul>\n              {this.props.startdates.map(x => {\n                return (<li\n                  className='startdate' key={String(x)}\n                  onClick={() => display.searchDate(window.data.tasks[util.stripR(x)].title,\n                    'start')}>\n                  {window.data.tasks[util.stripR(x)].title}</li>);\n              })}\n            </ul>}\n          {<TaskList ref={this.taskList} subtasks={this.subtasksCurrent}\n            parent={this} />}\n        </div>\n      </div>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}