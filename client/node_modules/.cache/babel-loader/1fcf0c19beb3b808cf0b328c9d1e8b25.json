{"ast":null,"code":"import _objectSpread from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./App.css';import{DragDropContext}from'react-beautiful-dnd';import popSnd from'../../assets/snd/pop.mp3';import*as edit from'../../services/edit/edit';import*as display from'../../services/display/display';import*as util from'../../services/util/util';import Frame from'../Frame/Frame';import StatusBar from'../StatusBar/StatusBar';// main app, governs everything\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.onDragEnd=function(result){var destination=result.destination,source=result.source;if(!destination){return;}if(destination.droppableId===source.droppableId&&destination.index===source.index){return;}var sourceSplit=source.droppableId.split('-');var destSplit=destination.droppableId.split('-');function buildList(listSplit){var listObjs=[];listObjs.push(window.app.current.state[listSplit[0]]);listObjs.push(listObjs[0].current.frames.find(function(x){return x.current.props.id===listSplit[1];}));var i=2;var task;function getTask(){task=listObjs[i-1].current.taskList.current.subtaskObjects.find(function(x){return x.current.props.id===listSplit[i];});listObjs.push(task);i++;}while(i<listSplit.length){getTask();}// returns the item to update\nreturn listObjs[listObjs.length-1];}var sourceItem=buildList(sourceSplit);var sourceState=sourceItem.current.state.subtasks;var splicedTask=sourceState.splice(source.index,1);sourceItem.current.setState({subtasks:sourceState});var destItem=buildList(destSplit);var destState=destItem.current.state.subtasks;destState.splice(destination.index,0,splicedTask[0]);destItem.current.setState({subtasks:destState});// splice in the new DATA from the source into the OBJECT of the destination\nedit.save(sourceItem.current);edit.save(destItem.current);window.selected=undefined;};_this.state={hideComplete:window.data.settings.hideComplete,bank:/*#__PURE__*/React.createRef(),river:/*#__PURE__*/React.createRef(),theme:window.data.settings.theme,mode:window.data.settings.mode,focused:window.data.settings.focused,popSnd:new Audio(popSnd),zoomed:'',disableSelect:'',contextMenu:/*#__PURE__*/React.createRef(),deadlines:window.data.settings.deadlines,startdates:window.data.settings.startdates,displayTable:'none'};return _this;}// hide/show completes\n_createClass(App,[{key:\"toggleComplete\",value:function toggleComplete(){var hideComplete;if(this.state.hideComplete===''){hideComplete='hideComplete';}else{hideComplete='';}this.setState({hideComplete:hideComplete});edit.saveSetting('hideComplete',hideComplete);display.updateAllSizes();}},{key:\"render\",value:function render(){this.statusBar=/*#__PURE__*/React.createRef();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(StatusBar,{parent:this,ref:this.statusBar,deadlines:this.state.deadlines,startdates:this.state.startdates}),/*#__PURE__*/_jsx(DragDropContext,{onDragEnd:this.onDragEnd,children:/*#__PURE__*/_jsxs(\"div\",{className:'container '+this.state.hideComplete+' '+this.state.zoomed+' '+this.state.disableSelect,children:[/*#__PURE__*/_jsx(Frame,{id:\"bank\",info:_objectSpread(_objectSpread({},window.data.tasks['bank'].info),{},{focused:window.data.settings.focused}),subtasks:window.data.tasks['bank'].subtasks,ref:this.state.bank}),/*#__PURE__*/_jsx(Frame,{id:\"river\",info:_objectSpread(_objectSpread({},window.data.tasks['river'].info),{},{focused:window.data.settings.focused}),deadlines:this.state.deadlines,startdates:this.state.startdates,subtasks:window.data.tasks['river'].subtasks,ref:this.state.river})]})}),/*#__PURE__*/_jsx(SelectMenu,{ref:this.state.contextMenu}),window.selected&&this.state.displayTable!=='none'&&/*#__PURE__*/_jsx(TableDisplay,{})]});}}]);return App;}(React.Component);// extra function menu tacked on after the drag/drop context\nexport{App as default};var SelectMenu=/*#__PURE__*/function(_React$Component2){_inherits(SelectMenu,_React$Component2);var _super2=_createSuper(SelectMenu);function SelectMenu(props){var _this2;_classCallCheck(this,SelectMenu);_this2=_super2.call(this,props);_this2.state={display:'none',top:'0',left:'0'};return _this2;}_createClass(SelectMenu,[{key:\"render\",value:function render(){this.self=/*#__PURE__*/React.createRef();return/*#__PURE__*/_jsxs(\"div\",{className:\"selectMenu\",ref:this.self,style:{display:this.state.display,top:this.state.top,left:this.state.left},children:[/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.newTask();},children:\"new task (return)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.cutTask();},children:\"cut (ctrl-x)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.copyTask();},children:\"copy (ctrl-c)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.copyTask(true);},children:\"mirror (ctrl-shift-C)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.pasteTask();},children:\"paste (ctrl-v)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.pasteTask(\"task\");},children:\"paste as subtask (ctrl-shift-V)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.deleteTask();},children:\"delete (ctrl-delete)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.moveTask(1);},children:\"move down (ctrl-s)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.moveTask(-1);},children:\"move up (ctrl-w)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return display.switchView(1);},children:\"following week/lists (ctrl-d)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return display.switchView(-1);},children:\"previous week/lists (ctrl-a)\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.listEdit('migrate');},children:\"migrate date\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return edit.listEdit('clear');},children:\"clear list\"}),/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return display.displayTable();},children:\"display as table\"})]});}}]);return SelectMenu;}(React.Component);var TableDisplay=/*#__PURE__*/function(_React$Component3){_inherits(TableDisplay,_React$Component3);var _super3=_createSuper(TableDisplay);function TableDisplay(){_classCallCheck(this,TableDisplay);return _super3.apply(this,arguments);}_createClass(TableDisplay,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{}),/*#__PURE__*/_jsx(\"tbody\",{children:window.data.tasks[util.stripR(window.selected.props.id)].subtasks.map(function(x){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:window.data.tasks[util.stripR(x)].title}),window.data.tasks[x].subtasks.map(function(y){return/*#__PURE__*/_jsx(\"td\",{children:window.data.tasks[util.stripR(y)].title},y);})]},x);})})]});}}]);return TableDisplay;}(React.Component);","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/components/App/App.js"],"names":["React","DragDropContext","popSnd","edit","display","util","Frame","StatusBar","App","props","onDragEnd","result","destination","source","droppableId","index","sourceSplit","split","destSplit","buildList","listSplit","listObjs","push","window","app","current","state","frames","find","x","id","i","task","getTask","taskList","subtaskObjects","length","sourceItem","sourceState","subtasks","splicedTask","splice","setState","destItem","destState","save","selected","undefined","hideComplete","data","settings","bank","createRef","river","theme","mode","focused","Audio","zoomed","disableSelect","contextMenu","deadlines","startdates","displayTable","saveSetting","updateAllSizes","statusBar","tasks","info","Component","SelectMenu","top","left","self","newTask","cutTask","copyTask","pasteTask","deleteTask","moveTask","switchView","listEdit","TableDisplay","stripR","map","title","y"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\nimport { DragDropContext } from 'react-beautiful-dnd';\nimport popSnd from '../../assets/snd/pop.mp3';\nimport * as edit from '../../services/edit/edit';\nimport * as display from '../../services/display/display';\nimport * as util from '../../services/util/util';\nimport Frame from '../Frame/Frame';\nimport StatusBar from '../StatusBar/StatusBar';\n\n// main app, governs everything\nexport default class App extends React.Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      hideComplete: window.data.settings.hideComplete,\n      bank: React.createRef(),\n      river: React.createRef(),\n      theme: window.data.settings.theme,\n      mode: window.data.settings.mode,\n      focused: window.data.settings.focused,\n      popSnd: new Audio(popSnd),\n      zoomed: '',\n      disableSelect: '',\n      contextMenu: React.createRef(),\n      deadlines: window.data.settings.deadlines,\n      startdates: window.data.settings.startdates,\n      displayTable: 'none',\n    };\n  }\n\n  // hide/show completes\n  toggleComplete() {\n    var hideComplete;\n    if (this.state.hideComplete === '') {\n      hideComplete = 'hideComplete';\n    } else {\n      hideComplete = '';\n    }\n    this.setState({ hideComplete: hideComplete });\n    edit.saveSetting('hideComplete', hideComplete);\n    display.updateAllSizes();\n  }\n  onDragEnd = result => {\n    const { destination, source } = result;\n    if (!destination) {\n      return;\n    }\n    if (destination.droppableId === source.droppableId &&\n      destination.index === source.index) {\n      return;\n    }\n    const sourceSplit = source.droppableId.split('-');\n    const destSplit = destination.droppableId.split('-');\n\n    function buildList(listSplit) {\n      var listObjs = [];\n      listObjs.push(window.app.current.state[listSplit[0]]);\n      listObjs.push(listObjs[0].current.frames.find(x =>\n        x.current.props.id === listSplit[1]));\n      var i = 2;\n      var task;\n      function getTask() {\n        task = listObjs[i - 1].current.taskList.current\n          .subtaskObjects.find(x => x.current.props.id === listSplit[i]);\n        listObjs.push(task);\n        i++;\n      }\n      while (i < listSplit.length) {\n        getTask();\n      }\n      // returns the item to update\n      return listObjs[listObjs.length - 1];\n    }\n    const sourceItem = buildList(sourceSplit);\n    const sourceState = sourceItem.current.state.subtasks;\n    const splicedTask = sourceState.splice(source.index, 1);\n    sourceItem.current.setState({ subtasks: sourceState });\n    const destItem = buildList(destSplit);\n    const destState = destItem.current.state.subtasks;\n    destState.splice(destination.index, 0, splicedTask[0]);\n    destItem.current.setState({ subtasks: destState });\n    // splice in the new DATA from the source into the OBJECT of the destination\n    edit.save(sourceItem.current);\n    edit.save(destItem.current);\n    window.selected = undefined;\n  }\n\n  render() {\n    this.statusBar = React.createRef();\n    return (\n      <>\n        <StatusBar parent={this} ref={this.statusBar} \n          deadlines={this.state.deadlines} \n          startdates={this.state.startdates} />\n        <DragDropContext onDragEnd={this.onDragEnd}>\n          <div className={'container ' + this.state.hideComplete + ' ' +\n            this.state.zoomed + ' ' + this.state.disableSelect}>\n            <Frame id='bank' info={{\n              ...window.data.tasks['bank'].info,\n              focused: window.data.settings.focused\n            }}\n              subtasks={window.data.tasks['bank'].subtasks} ref={this.state.bank} />\n            <Frame id='river' info={{\n              ...window.data.tasks['river'].info,\n              focused: window.data.settings.focused,\n            }}\n              deadlines={this.state.deadlines}\n              startdates={this.state.startdates}\n              subtasks={window.data.tasks['river'].subtasks} ref={this.state.river} />\n          </div>\n        </DragDropContext>\n        <SelectMenu ref={this.state.contextMenu}/>\n        {window.selected && this.state.displayTable !== 'none' &&\n          <TableDisplay />}\n      </>\n    )\n  }\n}\n\n// extra function menu tacked on after the drag/drop context\nclass SelectMenu extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { display: 'none', top: '0', left: '0' };\n  }\n  render() {\n    this.self = React.createRef();\n    return (\n      <div className='selectMenu' ref={this.self} style={{ display: this.state.display,\n        top: this.state.top, left: this.state.left }}>\n        <p onClick={() => edit.newTask()}>\n        new task (return)</p>\n        <p onClick={() => edit.cutTask()}>\n          cut (ctrl-x)</p>\n        <p onClick={() => edit.copyTask()}>\n          copy (ctrl-c)</p>\n        <p onClick={() => edit.copyTask(true)}>\n          mirror (ctrl-shift-C)</p>\n        <p onClick={() => edit.pasteTask()}>\n          paste (ctrl-v)</p>\n        <p onClick={() => edit.pasteTask(\"task\")}>\n          paste as subtask (ctrl-shift-V)</p>\n        <p onClick={() => edit.deleteTask()}>\n          delete (ctrl-delete)</p>\n        <p onClick={() => edit.moveTask(1)}>\n          move down (ctrl-s)</p>\n        <p onClick={() => edit.moveTask(-1)}>\n          move up (ctrl-w)</p>\n        <p onClick={() => display.switchView(1)}>\n          following week/lists (ctrl-d)</p>\n        <p onClick={() => display.switchView(-1)}>\n          previous week/lists (ctrl-a)</p>\n        <p onClick={() => edit.listEdit('migrate')}>\n          migrate date</p>\n        <p onClick={() => edit.listEdit('clear')}>\n          clear list</p>\n        <p onClick={() => display.displayTable()}>\n          display as table</p>\n      </div>\n    )\n  } \n}\n\nclass TableDisplay extends React.Component {\n  render() {\n    return (\n      <table className='table'>\n        <thead></thead>\n        <tbody>\n          {window.data.tasks[util.stripR(window.selected.props.id)].subtasks.map(x => (\n            <tr key={x}>\n              <td>{\n                window.data.tasks[util.stripR(x)].title\n              }</td>\n              {window.data.tasks[x].subtasks.map(y => (\n                <td key={y}>\n                  {window.data.tasks[util.stripR(y)].title\n                  }\n                </td>\n              ))}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}