{"ast":null,"code":"import _regeneratorRuntime from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./Frame.css';import*as display from'../../services/display';import*as util from'../../services/util';import List from'../List/List';import $ from'jquery';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Frame=/*#__PURE__*/function(_React$Component){_inherits(Frame,_React$Component);var _super=_createSuper(Frame);function Frame(props){var _this;_classCallCheck(this,Frame);_this=_super.call(this,props);_this.todayIndex=function(){var today=new Date();return _this.state.subtasks.findIndex(function(x){var now=new Date(window.data.tasks[x].title);return now.getDate()===today.getDate()&&now.getMonth()===today.getMonth()&&now.getFullYear()===today.getFullYear();});};_this.addList=function(id){// add a new list\nvar title;if(_this.props.id==='river'){var lastDate=new Date(window.data.tasks[_this.state.subtasks[_this.state.subtasks.length-1]].title);lastDate.setDate(lastDate.getDate()+1);title=lastDate.toDateString();}else{title='';}var subtasks=_this.state.subtasks;if(!id)id=String(new Date().getTime());else id=String(id);window.data.tasks[id]={title:title,subtasks:[],info:{}};subtasks.push(id);_this.setState({subtasks:subtasks});setTimeout(function(){_this.frames[_this.frames.length-1].current.listInput.current.focus();},100);};_this.addLists=function(){if(_this.props.id==='river'){var id=new Date().getTime();for(var i=0;i<7;i++){_this.addList(String(id+i));}}else{_this.addList();}};_this.changeIndex=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(val,set){var newIndex,finish;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(set===true){newIndex=val;}else{newIndex=_this.state.info.index+val;}if(_this.frame){_context.next=3;break;}return _context.abrupt(\"return\");case 3:finish=function finish(){var children=$(_this.frame.current).children();if(children[newIndex]){children[newIndex].scrollIntoView();}};_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{index:newIndex})},finish);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();_this.updatePosition=function(){if(_this.state.focused==='focused')return;if(_this.props.id!=='river')return;if(_this.scrollPos===undefined)_this.scrollPos=Math.floor($(_this.frameContainer.current).scrollLeft()/300)*300;var position=$(_this.frameContainer.current).scrollLeft();if(position<0)position=0;if(Math.abs(position-_this.scrollPos)>300){_this.scrollPos=Math.floor(position/300)*300;// this.setState({ index: this.state.shownIndex + \n//   Math.floor(scrollPos / 300) });\n_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{index:_this.state.shownIndex+Math.floor(_this.scrollPos/300)})});}};_this.state={subtasks:props.subtasks,info:props.info,width:display.processWidth(props.info.focused),zoomed:''};if(props.id==='river'){_this.state.repeats=window.data.settings.repeats;_this.state.shownIndex=_this.todayIndex();}else if(props.id==='bank'){_this.state.shownIndex=0;}return _this;}// find index of today in shownLists\n_createClass(Frame,[{key:\"componentDidMount\",value:function componentDidMount(){this.updatePosition();}},{key:\"render\",value:function render(){var _this2=this;var resizeCheck=function resizeCheck(){if(_this2.state.width!==display.processWidth(_this2.state.info.focused)){_this2.setState({width:display.processWidth(_this2.state.info.focused)});}};var endIndex=this.state.info.index+this.state.width;this.frames=[];window.addEventListener('resize',resizeCheck);var shownLists=this.state.subtasks.slice(this.state.shownIndex);this.frame=/*#__PURE__*/React.createRef();this.frameContainer=/*#__PURE__*/React.createRef();return/*#__PURE__*/_jsxs(\"div\",{className:\"frameContainer \\n        \".concat(this.state.info.focused,\" \").concat(this.state.zoomed,\" \").concat(this.props.id),onScroll:this.updatePosition,ref:this.frameContainer,children:[this.props.id==='river'&&this.state.info.focused!=='focused'&&/*#__PURE__*/_jsxs(\"div\",{className:\"monthYear\",children:[/*#__PURE__*/_jsx(\"span\",{children:window.data.tasks[this.state.subtasks[this.state.info.index]].title.slice(4,8)}),/*#__PURE__*/_jsx(\"span\",{children:window.data.tasks[this.state.subtasks[this.state.info.index]].title.slice(11)})]}),/*#__PURE__*/_jsxs(\"div\",{id:this.props.id,className:'frame',ref:this.frame,children:[shownLists.map(function(x){_this2.frames.push(/*#__PURE__*/React.createRef());var task=window.data.tasks[x];if(_this2.props.id==='river'){// render state correctly in original lists\nreturn/*#__PURE__*/_jsx(List,{id:x,title:task.title,subtasks:task.subtasks,parent:_this2,deadlines:_this2.props.deadlines[task.title],startdates:_this2.props.startdates[task.title],repeats:_this2.state.repeats[util.dateFormat(task.title).slice(0,3)],ref:_this2.frames[_this2.frames.length-1]},x);}else{return/*#__PURE__*/_jsx(List,{id:x,title:task.title,subtasks:task.subtasks,parent:_this2,ref:_this2.frames[_this2.frames.length-1]},x);}}),/*#__PURE__*/_jsx(\"button\",{className:\"changeButton\",title:\"add list or date\",onClick:function onClick(){return _this2.addLists();},children:\"+\"})]})]});}}]);return Frame;}(React.Component);export{Frame as default};","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/components/Frame/Frame.js"],"names":["React","display","util","List","$","Frame","props","todayIndex","today","Date","state","subtasks","findIndex","x","now","window","data","tasks","title","getDate","getMonth","getFullYear","addList","id","lastDate","length","setDate","toDateString","String","getTime","info","push","setState","setTimeout","frames","current","listInput","focus","addLists","i","changeIndex","val","set","newIndex","index","frame","finish","children","scrollIntoView","updatePosition","focused","scrollPos","undefined","Math","floor","frameContainer","scrollLeft","position","abs","shownIndex","width","processWidth","zoomed","repeats","settings","resizeCheck","endIndex","addEventListener","shownLists","slice","createRef","map","task","deadlines","startdates","dateFormat","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Frame.css';\nimport * as display from '../../services/display';\nimport * as util from '../../services/util';\nimport List from '../List/List';\nimport $ from 'jquery';\n\nexport default class Frame extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      subtasks: props.subtasks, info: props.info,\n      width: display.processWidth(props.info.focused),\n      zoomed: '',\n    };\n    if (props.id === 'river') {\n      this.state.repeats = window.data.settings.repeats;\n      this.state.shownIndex = this.todayIndex();\n    } else if (props.id === 'bank') {\n      this.state.shownIndex = 0;\n    }\n  }\n\n  // find index of today in shownLists\n  todayIndex = () => {\n    const today = new Date();\n    return this.state.subtasks.findIndex(x => {\n      const now = new Date(window.data.tasks[x].title);\n      return now.getDate() === today.getDate() &&\n        now.getMonth() === today.getMonth() &&\n        now.getFullYear() === today.getFullYear()\n    })\n  }\n\n  // create a new list\n  addList = (id) => {\n    // add a new list\n    var title;\n    if (this.props.id === 'river') {\n      const lastDate = new Date(\n        window.data.tasks[this.state.subtasks[this.state.subtasks.length - 1]].title);\n      lastDate.setDate(lastDate.getDate() + 1);\n      title = lastDate.toDateString();\n    } else {\n      title = '';\n    }\n\n    const subtasks = this.state.subtasks;\n    if (!id) id = String(new Date().getTime());\n    else id = String(id);\n    window.data.tasks[id] = {\n      title: title, subtasks: [], info: {}\n    }\n    subtasks.push(id);\n    this.setState({subtasks: subtasks});\n    setTimeout(() => {\n      this.frames[this.frames.length - 1].current.listInput.current.focus();\n    }, 100);\n  }\n\n  addLists = () => {\n    if (this.props.id === 'river') {\n      const id = new Date().getTime();\n      for (let i = 0; i < 7; i ++) {\n        this.addList(String(id + i));\n      }\n    } else {\n      this.addList();\n    }\n  }\n\n  changeIndex = async (val, set) => {\n    var newIndex;\n    if (set === true) {\n      newIndex = val;\n    } else {\n      newIndex = this.state.info.index + val;\n    }\n    if (!this.frame) return;\n\n    const finish = () => {\n      const children = $(this.frame.current).children();\n      if (children[newIndex]) {\n        children[newIndex].scrollIntoView();\n      }\n    }\n\n    this.setState({\n      info: {...this.state.info, index: newIndex}\n    }, finish);\n  }\n\n  updatePosition = () => {\n    if (this.state.focused === 'focused') return;\n    if (this.props.id !== 'river') return;\n    if (this.scrollPos === undefined) this.scrollPos = \n      Math.floor($(this.frameContainer.current).scrollLeft() / 300) * 300;\n    let position = $(this.frameContainer.current).scrollLeft();\n    if (position < 0) position = 0;\n    if (Math.abs(position - this.scrollPos) > 300) {\n      this.scrollPos = Math.floor(position / 300) * 300;\n      // this.setState({ index: this.state.shownIndex + \n      //   Math.floor(scrollPos / 300) });\n      this.setState({ info: \n        {\n          ...this.state.info, \n          index: this.state.shownIndex + Math.floor(this.scrollPos / 300)\n        }\n      });\n    }\n  }\n\n  componentDidMount() {\n    this.updatePosition();\n  }\n\n  render() {\n    var resizeCheck = () => {\n      if (this.state.width !== display.processWidth(this.state.info.focused)) {\n        this.setState({ width: display.processWidth(this.state.info.focused) });\n      }\n    }\n    let endIndex = this.state.info.index + this.state.width;\n    this.frames = [];\n    window.addEventListener('resize', resizeCheck);\n    const shownLists = this.state.subtasks.slice(\n      this.state.shownIndex\n    );\n    this.frame = React.createRef();\n    this.frameContainer = React.createRef();\n    return (\n      <div className={`frameContainer \n        ${this.state.info.focused} ${this.state.zoomed} ${this.props.id}`}\n        onScroll={this.updatePosition} ref={this.frameContainer}>\n        {this.props.id === 'river' &&\n        this.state.info.focused !== 'focused' &&\n        <div className='monthYear'>\n          <span>{\n            window.data.tasks[this.state.subtasks[this.state.info.index]]\n              .title.slice(4, 8)}</span>\n          <span>{\n            window.data.tasks[this.state.subtasks[this.state.info.index]]\n              .title.slice(11)}</span>\n        </div>}\n        <div id={this.props.id}\n          className={'frame'} ref={this.frame}>\n          {shownLists.map(x => {\n            this.frames.push(React.createRef());\n            const task = window.data.tasks[x];\n            if (this.props.id === 'river') {\n              // render state correctly in original lists\n              return (\n                <List key={x} id={x} title={task.title}\n                  subtasks={task.subtasks} parent={this}\n                  deadlines={this.props.deadlines[task.title]}\n                  startdates={this.props.startdates[task.title]}\n                  repeats={this.state.repeats[util.dateFormat(task.title)\n                    .slice(0, 3)]}\n                  ref={this.frames[this.frames.length - 1]} />\n              )\n            } else {\n              return (\n                <List key={x} id={x} title={task.title}\n                  subtasks={task.subtasks} parent={this}\n                  ref={this.frames[this.frames.length - 1]} />\n              )\n            }\n          })}\n          <button className='changeButton' title='add list or date'\n            onClick={() => this.addLists()}>+</button>\n        </div>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}