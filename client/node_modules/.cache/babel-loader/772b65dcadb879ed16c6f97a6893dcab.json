{"ast":null,"code":"import * as display from '../display/display';\nimport * as edit from '../edit/edit';\nimport Task from '../../components/Task/Task';\nimport List from '../../components/List/List';\nimport $ from '../../utils/jquery';\nexport function keyComms(ev) {\n  if (!ev.ctrlKey) {\n    if (ev.key === 'Enter' && !window.preventReturn) {\n      ev.preventDefault();\n\n      if (ev.shiftKey) {\n        edit.newTask('task');\n      } else {\n        edit.newTask();\n      }\n\n      return;\n    } else if (ev.key === 'Escape' && !window.preventReturn) {\n      ev.preventDefault();\n      if (window.app.current.state.displayTable !== 'none') display.displayTable();\n      document.activeElement.blur();\n\n      if (window.selected) {\n        edit.save(window.selected, 'task');\n\n        if (window.selected instanceof Task && window.selected.state.displayOptions === 'show') {\n          window.selected.displayOptions('hide');\n        } else {\n          window.selected = undefined;\n        }\n      }\n\n      return;\n    }\n  }\n\n  if (ev.ctrlKey && ev.shiftKey) {\n    switch (ev.key) {\n      case 'V':\n        edit.pasteTask('task');\n        break;\n\n      case 'N':\n        edit.newTask('task');\n        break;\n\n      case 'F':\n        ev.preventDefault();\n        display.zoom();\n        break;\n\n      case 'C':\n        // mirror task\n        edit.copyTask(true);\n        break;\n\n      default:\n        break;\n    }\n  } else if (ev.ctrlKey) {\n    switch (ev.key) {\n      case 'x':\n        ev.preventDefault();\n        edit.cutTask();\n        break;\n\n      case 'c':\n        ev.preventDefault();\n        edit.copyTask();\n        break;\n\n      case 'v':\n        ev.preventDefault();\n        edit.pasteTask();\n        break;\n\n      case 'n':\n        ev.preventDefault();\n        edit.newTask();\n        break;\n\n      case ']':\n        ev.preventDefault();\n        edit.indentTask();\n        break;\n\n      case '[':\n        ev.preventDefault();\n        edit.indentTask(true);\n        break;\n\n      case 'f':\n        ev.preventDefault();\n        display.focus();\n        break;\n\n      case 'z':\n        ev.preventDefault();\n        edit.undo();\n        break;\n\n      case 'r':\n        ev.preventDefault();\n        display.updateAllSizes();\n        break;\n\n      case 'Backspace':\n        ev.preventDefault();\n\n        if (window.selected && window.selected instanceof Task) {\n          window.selected.deleteThis();\n        } else if (window.selected && window.selected instanceof List && window.selected.props.parent.props.id === 'bank') {\n          const confirm = window.confirm('delete this list?');\n\n          if (confirm) {\n            const subtasks = window.selected.props.parent.state.subtasks;\n            window.undoData = localStorage.getItem('data');\n            subtasks.splice(subtasks.findIndex(x => x === window.selected.props.id), 1);\n            window.selected.props.parent.setState({\n              subtasks: subtasks\n            });\n          }\n        }\n\n        break;\n\n      case 'w':\n        ev.preventDefault();\n\n        if (window.selected.props.parent.props.id != 'river') {\n          edit.moveTask(-1);\n        }\n\n        break;\n\n      case 's':\n        ev.preventDefault();\n\n        if (window.selected.props.parent.props.id != 'river') {\n          edit.moveTask(1);\n        }\n\n        break;\n\n      case 'a':\n        ev.preventDefault();\n        display.switchView(-1);\n        break;\n\n      case 'd':\n        ev.preventDefault();\n        display.switchView(1);\n        break;\n\n      case 'h':\n        ev.preventDefault();\n        window.app.current.toggleComplete();\n        break;\n\n      case 't':\n        ev.preventDefault();\n        if (window.app.current.state.zoomed === 'zoomed') return;\n        display.goToToday();\n        break;\n\n      case '1':\n        ev.preventDefault();\n\n        if (window.selected instanceof Task) {\n          window.selected.toggleComplete(false);\n        }\n\n        break;\n\n      case '2':\n        ev.preventDefault();\n\n        if (window.selected instanceof Task) {\n          window.selected.toggleImportant(false);\n        }\n\n        break;\n\n      case '3':\n        ev.preventDefault();\n\n        if (window.selected instanceof Task) {\n          window.selected.toggleMaybe(false);\n        }\n\n        break;\n\n      case 'i':\n        ev.preventDefault();\n\n        if (window.selected && window.selected instanceof Task) {\n          window.selected.displayOptions({\n            target: $('<p></p>')\n          });\n\n          if (window.selected.state.displayOptions === 'hide') {\n            window.selected.editBar.current.focus();\n          }\n        }\n\n        ;\n        break;\n\n      default:\n        break;\n    }\n  }\n}","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/services/keyComms/keyComms.js"],"names":["display","edit","Task","List","$","keyComms","ev","ctrlKey","key","window","preventReturn","preventDefault","shiftKey","newTask","app","current","state","displayTable","document","activeElement","blur","selected","save","displayOptions","undefined","pasteTask","zoom","copyTask","cutTask","indentTask","focus","undo","updateAllSizes","deleteThis","props","parent","id","confirm","subtasks","undoData","localStorage","getItem","splice","findIndex","x","setState","moveTask","switchView","toggleComplete","zoomed","goToToday","toggleImportant","toggleMaybe","target","editBar"],"mappings":"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","sourcesContent":["import * as display from '../display/display';\nimport * as edit from '../edit/edit';\nimport Task from '../../components/Task/Task';\nimport List from '../../components/List/List';\nimport $ from '../../utils/jquery';\n\nexport function keyComms(ev) {\n  if (!ev.ctrlKey) {\n    if (ev.key === 'Enter' && !window.preventReturn) {\n      ev.preventDefault();\n      if (ev.shiftKey) {\n        edit.newTask('task');\n      } else {\n        edit.newTask();\n      }\n      return;\n    } else if (ev.key === 'Escape' && !window.preventReturn) {\n      ev.preventDefault();\n      if (window.app.current.state.displayTable !== 'none') display.displayTable();\n      document.activeElement.blur();\n      if (window.selected) {\n        edit.save(window.selected, 'task');\n        if (window.selected instanceof Task &&\n          window.selected.state.displayOptions === 'show') {\n          window.selected.displayOptions('hide');\n        } else {\n          window.selected = undefined;\n        }\n      }\n      return;\n    }\n  }\n  if (ev.ctrlKey && ev.shiftKey) {\n    switch (ev.key) {\n      case 'V':\n        edit.pasteTask('task');\n        break;\n      case 'N':\n        edit.newTask('task');\n        break;\n      case 'F':\n        ev.preventDefault();\n        display.zoom();\n        break;\n      case 'C':\n        // mirror task\n        edit.copyTask(true);\n        break;\n      default:\n        break;\n    }\n  } else if (ev.ctrlKey) {\n    switch (ev.key) {\n      case 'x':\n        ev.preventDefault();\n        edit.cutTask();\n        break;\n      case 'c':\n        ev.preventDefault();\n        edit.copyTask();\n        break;\n      case 'v':\n        ev.preventDefault();\n        edit.pasteTask();\n        break;\n      case 'n':\n        ev.preventDefault();\n        edit.newTask();\n        break;\n      case ']':\n        ev.preventDefault();\n        edit.indentTask();\n        break;\n      case '[':\n        ev.preventDefault();\n        edit.indentTask(true);\n        break;\n      case 'f':\n        ev.preventDefault();\n        display.focus();\n        break;\n      case 'z':\n        ev.preventDefault();\n        edit.undo();\n        break;\n      case 'r':\n        ev.preventDefault();\n        display.updateAllSizes();\n        break;\n      case 'Backspace':\n        ev.preventDefault();\n        if (window.selected && window.selected instanceof Task) {\n          window.selected.deleteThis();\n        } else if (window.selected && window.selected instanceof List &&\n          window.selected.props.parent.props.id === 'bank') {\n          const confirm = window.confirm('delete this list?');\n          if (confirm) {\n            const subtasks = window.selected.props.parent.state.subtasks;\n            window.undoData = localStorage.getItem('data');\n            subtasks.splice(\n              subtasks.findIndex(x => x === window.selected.props.id), 1);\n            window.selected.props.parent.setState({ subtasks: subtasks });\n          }\n        }\n        break;\n      case 'w':\n        ev.preventDefault();\n        if (window.selected.props.parent.props.id != 'river') {\n          edit.moveTask(-1);\n        }\n        break;\n      case 's':\n        ev.preventDefault();\n        if (window.selected.props.parent.props.id != 'river') {\n          edit.moveTask(1);\n        }\n        break;\n      case 'a':\n        ev.preventDefault();\n        display.switchView(-1);\n        break;\n      case 'd':\n        ev.preventDefault();\n        display.switchView(1);\n        break;\n      case 'h':\n        ev.preventDefault();\n        window.app.current.toggleComplete();\n        break;\n      case 't':\n        ev.preventDefault();\n        if (window.app.current.state.zoomed === 'zoomed') return;\n        display.goToToday();\n        break;\n      case '1':\n        ev.preventDefault();\n        if (window.selected instanceof Task) {\n          window.selected.toggleComplete(false);\n        }\n        break;\n      case '2':\n        ev.preventDefault();\n        if (window.selected instanceof Task) {\n          window.selected.toggleImportant(false);\n        }\n        break;\n      case '3':\n        ev.preventDefault();\n        if (window.selected instanceof Task) {\n          window.selected.toggleMaybe(false);\n        }\n        break;\n      case 'i':\n        ev.preventDefault();\n        if (window.selected && window.selected instanceof Task) {\n          window.selected.displayOptions({ target: $('<p></p>') });\n          if (window.selected.state.displayOptions === 'hide') {\n            window.selected.editBar.current.focus();\n          }\n        };\n        break;\n      default:\n        break;\n    }\n  }\n}"]},"metadata":{},"sourceType":"module"}