{"ast":null,"code":"var _jsxFileName = \"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/components/StatusBar/StatusBar.js\";\nimport React from 'react';\nimport './StatusBar.css';\nimport timerSnd from '../../assets/snd/timer.mp3';\nimport startSnd from '../../assets/snd/start.mp3';\nimport * as display from '../../services/display/display';\nimport * as edit from '../../services/edit/edit';\nimport * as util from '../../services/util/util';\nimport * as saving from '../../services/saving/saving';\nimport $ from 'jquery';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default class StatusBar extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.tutorial = () => {\n      this.setState({\n        tutorial: true\n      });\n\n      const myFunc = ev => {\n        if (!$(ev.target).hasClass('tutorialShow')) {\n          this.setState({\n            tutorial: false\n          });\n          $(window).off('click', myFunc);\n        }\n      };\n\n      setTimeout(() => {\n        $(window).on('click', myFunc);\n      }, 100);\n    };\n\n    this.state = {\n      searchString: '',\n      foundTasks: {}\n    };\n  }\n\n  search(ev) {\n    if (this.state.searchString === '') {\n      this.searches = { ...window.data.tasks\n      };\n    }\n\n    this.setState({\n      searchString: ev.target.value\n    });\n\n    for (let x of Object.keys(this.searches)) {\n      if (!new RegExp(this.state.searchString, 'i').test(this.searches[x].title) || this.searches[x].info.complete === 'complete') {\n        delete this.searches[x];\n      }\n    } // id : {title, subtasks, info}\n\n\n    this.setState({\n      foundTasks: this.searches\n    });\n  }\n\n  goToSearch(id) {\n    window.preventReturn = true;\n    window.preventSelect = true;\n    var idList = [id];\n\n    function buildParents(otherId) {\n      for (let x of Object.keys(window.data.tasks)) {\n        if (window.data.tasks[util.stripR(x)].subtasks.includes(otherId)) {\n          idList.splice(0, 0, x);\n          buildParents(x);\n          return;\n        }\n      }\n    }\n\n    buildParents(id);\n    const frame = window.app.current.state[idList[0]].current;\n    const listIndex = frame.state.subtasks.slice(frame.state.shownIndex).findIndex(x => x === idList[1]);\n    frame.changeIndex(listIndex, true);\n    this.setState({\n      searchString: '',\n      foundTasks: {}\n    });\n    setTimeout(() => {\n      const list = frame.frames[listIndex].current;\n      let foundTask = list;\n      let i = 2;\n\n      while (idList.length > i) {\n        // find in tasks starting at index 2 (if it's there)\n        let taskId = idList[i];\n        let taskIndex;\n\n        if (foundTask.subtasksCurrent && foundTask.subtasksCurrent.length > 0) {\n          taskIndex = foundTask.subtasksCurrent.findIndex(x => x === taskId);\n        } else {\n          taskIndex = foundTask.state.subtasks.findIndex(x => x === taskId);\n        }\n\n        foundTask = foundTask.taskList.current.subtaskObjects[taskIndex].current;\n        i++;\n      }\n\n      window.preventSelect = false;\n      edit.selectTask(foundTask); // go through IDs and find the trace paths\n\n      setTimeout(() => {\n        window.preventReturn = false;\n      }, 100);\n    }, 100);\n  }\n\n  componentDidMount() {\n    setTimeout(display.goToToday, 200);\n  }\n\n  goToFirst() {\n    this.goToSearch($($(this.searchResults.current).children()[0]).attr('value'));\n  }\n\n  render() {\n    this.search = this.search.bind(this);\n    this.goToSearch = this.goToSearch.bind(this);\n    this.goToFirst = this.goToFirst.bind(this);\n    this.searchResults = /*#__PURE__*/React.createRef();\n    this.searchBar = /*#__PURE__*/React.createRef();\n    this.options = /*#__PURE__*/React.createRef();\n    this.functions = /*#__PURE__*/React.createRef();\n    this.move = /*#__PURE__*/React.createRef();\n    this.upcoming = /*#__PURE__*/React.createRef();\n    let deadlineItems = Object.keys(this.props.deadlines).filter(x => new Date(x).getTime() >= new Date().getTime());\n    deadlineItems = deadlineItems.map(x => this.props.deadlines[x].map(y => [x, y])).flat().filter(x => x.length > 0);\n    this.functionsDict = {\n      'newTask': edit.newTask,\n      'newSubtask': () => edit.newTask(\"task\"),\n      'cutTask': edit.cutTask,\n      'copyTask': edit.copyTask,\n      'copyTaskTrue': () => edit.copyTask(true),\n      'pasteTask': edit.pasteTask,\n      'pasteTaskTask': () => edit.pasteTask('task'),\n      'deleteTask': edit.deleteTask,\n      'moveTaskUp': () => edit.moveTask(-1),\n      'moveTaskDown': () => edit.moveTask(1),\n      'switchView': () => display.switchView(1),\n      'listEditMigrate': () => edit.listEdit('migrate'),\n      'listEditClear': () => edit.listEdit('clear'),\n      'displayTable': display.displayTable,\n      'focus': display.focus,\n      'zoom': display.zoom,\n      'undo': edit.undo,\n      'toggleComplete': () => window.app.current.toggleComplete(),\n      'backup': saving.backup,\n      'restore': saving.restore,\n      'reset': saving.reset,\n      'toggleSounds': display.toggleSounds,\n      'toggleMode': display.toggleMode,\n      'setThemeSpace': () => display.setTheme(\"space\"),\n      'setThemeSky': () => display.setTheme(\"sky\"),\n      'setThemeWater': () => display.setTheme(\"water\"),\n      'setThemeEarth': () => display.setTheme(\"earth\"),\n      'setThemeFire': () => display.setTheme(\"fire\"),\n      'indent': edit.indentTask,\n      'unindent': () => edit.indentTask(true),\n      'togglePast': () => {\n        if (window.app.current.river.state.shownIndex !== 0) {\n          window.app.current.river.setState({\n            shownIndex: 0\n          });\n          display.goToToday();\n        } else {\n          window.app.current.river.setState({\n            shownIndex: window.app.current.river.todayIndex()\n          });\n        }\n      }\n    };\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"statusBar\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"title\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"r\",\n            children: \"River\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"b\",\n            children: \"Bank\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            flexDirection: 'column',\n            position: 'relative'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            ref: this.searchBar,\n            className: \"searchBar\",\n            onChange: ev => this.search(ev),\n            value: this.state.searchString,\n            onKeyDown: ev => {\n              if (ev.key === 'Backspace') {\n                ev.preventDefault();\n                this.setState({\n                  searchString: '',\n                  foundTasks: {}\n                });\n              } else if (ev.key === 'Enter') {\n                ev.preventDefault();\n\n                if ($(this.searchResults.current).children().length > 0) {\n                  this.goToFirst();\n                }\n              }\n            },\n            placeholder: \"search\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 11\n          }, this), this.state.searchString.length > 0 && /*#__PURE__*/_jsxDEV(\"select\", {\n            ref: this.searchResults,\n            style: {\n              width: '5em'\n            },\n            onChange: () => {\n              this.goToSearch(this.searchResults.current.value);\n            },\n            children: Object.keys(this.state.foundTasks).map(x => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: x,\n              children: this.state.foundTasks[x].title\n            }, x, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(Timer, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"buttonBar nowrap\",\n          children: [/*#__PURE__*/_jsxDEV(\"select\", {\n            defaultValue: \"\",\n            ref: this.functions,\n            style: {\n              width: '35px'\n            },\n            onChange: () => {\n              this.functionsDict[this.functions.current.value].call();\n              this.functions.current.value = '';\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              disabled: true,\n              hidden: true,\n              children: \"edit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"newTask\",\n              children: \"new task (return)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"newSubtask\",\n              children: \"new subtask (shift-return)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"cutTask\",\n              children: \"cut (ctrl-x)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"copyTask\",\n              children: \"copy (ctrl-c)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"copyTaskTrue\",\n              children: \"mirror (ctrl-shift-C)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 213,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"pasteTask\",\n              children: \"paste (ctrl-v)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 215,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"pasteTaskTask\",\n              children: \"paste as subtask (ctrl-shift-V)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 217,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"deleteTask\",\n              children: \"delete (ctrl-delete)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 219,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            defaultValue: \"\",\n            ref: this.move,\n            style: {\n              width: '45px'\n            },\n            onChange: () => {\n              this.functionsDict[this.move.current.value].call();\n              this.move.current.value = '';\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              disabled: true,\n              hidden: true,\n              children: \"move\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 227,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"moveTaskUp\",\n              children: \"move up (ctrl-w)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"moveTaskDown\",\n              children: \"move down (ctrl-s)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"indent\",\n              children: \"indent (ctrl-])\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"unindent\",\n              children: \"unindent (ctrl-[)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 234,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"switchView\",\n              children: \"following week/lists (ctrl-d)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"switchView(-1)\",\n              children: \"previous week/lists (ctrl-a)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 238,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"listEditMigrate\",\n              children: \"migrate date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"listEditClear\",\n              children: \"clear list\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 242,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"displayTable\",\n              children: \"display as table\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"togglePast\",\n              children: \"show/hide past dates\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 246,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            defaultValue: \"\",\n            ref: this.options,\n            onChange: () => {\n              this.functionsDict[this.options.current.value].call();\n              this.options.current.value = '';\n            },\n            style: {\n              width: '60px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              disabled: true,\n              hidden: true,\n              children: \"settings\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 254,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"focus\",\n              children: \"focus on list (ctrl-f)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 255,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"zoom\",\n              children: \"focus on view (ctrl-shift-F)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"toggleComplete\",\n              children: \"show/hide complete (ctrl-h)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"undo\",\n              children: \"undo (ctrl-z)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"backup\",\n              children: \"backup\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"restore\",\n              children: \"restore\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"reset\",\n              children: \"reset\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"toggleSounds\",\n              children: \"toggle sounds\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"toggleMode\",\n              children: \"toggle day/night\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"setThemeSpace\",\n              children: \"theme: space\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"setThemeSky\",\n              children: \"theme: sky\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"setThemeWater\",\n              children: \"theme: water\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"setThemeEarth\",\n              children: \"theme: earth\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"setThemeFire\",\n              children: \"theme: fire\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(ListMenu, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            defaultValue: \"\",\n            ref: this.upcoming,\n            onChange: () => {\n              this.goToSearch(this.upcoming.current.value);\n              this.upcoming.current.value = '';\n            },\n            style: {\n              width: '75px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"\",\n              disabled: true,\n              hidden: true,\n              children: \"upcoming\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 13\n            }, this), deadlineItems.map(x => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: util.stripR(x[1]),\n              children: [x[0].slice(0, x[0].length - 5), \": \", window.data.tasks[util.stripR(x[1])].title]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 15\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          className: \"tutorialLink\",\n          onClick: this.tutorial,\n          children: \"help\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 7\n      }, this), this.state.tutorial && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tutorial tutorialShow\",\n        children: /*#__PURE__*/_jsxDEV(\"video\", {\n          controls: true,\n          className: \"tutorialShow\",\n          children: /*#__PURE__*/_jsxDEV(\"source\", {\n            src: \"../../assets/media/tutorial.mp4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nclass ListMenu extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      bankLists: props.bankLists,\n      riverLists: props.riverLists\n    };\n  }\n\n  goToList(type) {\n    if (type === 'river') {\n      display.searchDate(this.riverLister.current.value);\n    } else if (type === 'bank') {\n      var parent = window.app.current.state.bank.current;\n      var list = this.bankLister;\n      parent.changeIndex(Number(list.current.value), true);\n    }\n\n    if (type === 'river') {\n      this.riverLister.current.value = '';\n    } else if (type === 'bank') {\n      this.bankLister.current.value = '';\n    }\n  }\n\n  render() {\n    this.riverLister = /*#__PURE__*/React.createRef();\n    this.bankLister = /*#__PURE__*/React.createRef();\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n        defaultValue: \"\",\n        ref: this.bankLister,\n        onChange: () => this.goToList('bank'),\n        style: {\n          width: '35px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          disabled: true,\n          hidden: true,\n          children: \"lists\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 11\n        }, this), window.data.tasks['bank'].subtasks.filter(x => window.data.tasks[x].title !== '--').map((x, index) => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: index,\n          children: window.data.tasks[x].title\n        }, x, false, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        defaultValue: \"\",\n        ref: this.riverLister,\n        onChange: () => {\n          if (this.riverLister.current.value === 'today') {\n            display.goToToday();\n            this.riverLister.current.value = '';\n          } else {\n            this.goToList('river');\n          }\n        },\n        style: {\n          width: '45px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          disabled: true,\n          hidden: true,\n          children: \"dates\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"today\",\n          children: \"today (ctrl-t)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 11\n        }, this), window.data.tasks['river'].subtasks.filter(x => new Date(window.data.tasks[x].title).getTime() >= new Date().getTime()).map(x => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: window.data.tasks[x].title,\n          children: window.data.tasks[x].title\n        }, x, false, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nclass Timer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      seconds: 0,\n      audio: new Audio(timerSnd),\n      start: new Audio(startSnd),\n      startTime: undefined,\n      ended: false\n    };\n  }\n\n  startTimer(val) {\n    const endTime = new Date(new Date().getTime() + val * 60 * 1000).getTime();\n    this.setState({\n      endTime: endTime,\n      seconds: val * 60\n    });\n    display.playSound(this.state.start);\n    this.play();\n  }\n\n  play(stopwatch, backwards) {\n    Notification.requestPermission();\n    clearInterval(this.interval);\n    this.setState({\n      ended: false\n    });\n\n    if (stopwatch === 'stopwatch') {\n      display.playSound(this.state.start);\n      this.interval = setInterval(() => {\n        this.setState({\n          seconds: this.state.seconds + 1\n        });\n      }, 1000);\n    } else {\n      this.interval = setInterval(() => {\n        this.setState({\n          seconds: Math.ceil((this.state.endTime - new Date().getTime()) / 1000)\n        });\n\n        if (this.state.seconds <= 0 && this.state.ended === false) {\n          this.end();\n        }\n      }, 1000);\n    }\n  }\n\n  end() {\n    this.setState({\n      play: true,\n      ended: true\n    });\n    display.playSound(this.state.audio);\n    this.options.current.value = '';\n    new Notification('timer complete');\n  }\n\n  playPause() {\n    clearInterval(this.interval);\n    this.setState({\n      seconds: 0\n    });\n    this.options.current.value = '';\n  }\n\n  render() {\n    this.startTimer = this.startTimer.bind(this);\n    this.playPause = this.playPause.bind(this);\n    this.play = this.play.bind(this);\n    this.audioRef = /*#__PURE__*/React.createRef();\n    this.options = /*#__PURE__*/React.createRef();\n    var timeReadout;\n\n    if (this.state.seconds >= 0) {\n      timeReadout = Math.floor(this.state.seconds / 60) + ':' + String(this.state.seconds - Math.floor(this.state.seconds / 60) * 60).padStart(2, '0');\n    } else {\n      if (this.state.seconds / 60 === Math.floor(this.state.seconds / 60) && this.state.seconds !== 0) {\n        // right on minute\n        timeReadout = '-' + -1 * Math.floor(this.state.seconds / 60) + ':00';\n      } else {\n        timeReadout = '-' + -1 * (Math.floor(this.state.seconds / 60) + 1) + ':' + String(60 - (this.state.seconds - Math.floor(this.state.seconds / 60) * 60)).padStart(2, '0');\n      }\n    }\n\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"timerBar\",\n        readOnly: true,\n        value: timeReadout\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        value: \"\",\n        ref: this.options,\n        onChange: () => {\n          if (this.options.current.value === 'clear') {\n            this.playPause();\n            this.options.current.value = '';\n          } else if (this.options.current.value === 'stopwatch') {\n            this.setState({\n              seconds: 0\n            });\n            this.play('stopwatch');\n            this.options.current.value = '';\n          } else {\n            this.startTimer(this.options.current.value);\n            this.options.current.value = '';\n          }\n        },\n        style: {\n          width: '45px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          disabled: true,\n          hidden: true,\n          children: \"timer\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: 'clear',\n          children: \"--:--\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: 50,\n          children: \"50:00\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: 25,\n          children: \"25:00\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: 15,\n          children: \"15:00\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: 10,\n          children: \"10:00\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: 5,\n          children: \"5:00\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 456,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: 'stopwatch',\n          title: \"stopwatch\",\n          children: \"\\u221E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/components/StatusBar/StatusBar.js"],"names":["React","timerSnd","startSnd","display","edit","util","saving","$","StatusBar","Component","constructor","props","tutorial","setState","myFunc","ev","target","hasClass","window","off","setTimeout","on","state","searchString","foundTasks","search","searches","data","tasks","value","x","Object","keys","RegExp","test","title","info","complete","goToSearch","id","preventReturn","preventSelect","idList","buildParents","otherId","stripR","subtasks","includes","splice","frame","app","current","listIndex","slice","shownIndex","findIndex","changeIndex","list","frames","foundTask","i","length","taskId","taskIndex","subtasksCurrent","taskList","subtaskObjects","selectTask","componentDidMount","goToToday","goToFirst","searchResults","children","attr","render","bind","createRef","searchBar","options","functions","move","upcoming","deadlineItems","deadlines","filter","Date","getTime","map","y","flat","functionsDict","newTask","cutTask","copyTask","pasteTask","deleteTask","moveTask","switchView","listEdit","displayTable","focus","zoom","undo","toggleComplete","backup","restore","reset","toggleSounds","toggleMode","setTheme","indentTask","river","todayIndex","flexDirection","position","key","preventDefault","width","call","ListMenu","bankLists","riverLists","goToList","type","searchDate","riverLister","parent","bank","bankLister","Number","index","Timer","seconds","audio","Audio","start","startTime","undefined","ended","startTimer","val","endTime","playSound","play","stopwatch","backwards","Notification","requestPermission","clearInterval","interval","setInterval","Math","ceil","end","playPause","audioRef","timeReadout","floor","String","padStart"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './StatusBar.css';\nimport timerSnd from '../../assets/snd/timer.mp3';\nimport startSnd from '../../assets/snd/start.mp3';\nimport * as display from '../../services/display/display';\nimport * as edit from '../../services/edit/edit';\nimport * as util from '../../services/util/util';\nimport * as saving from '../../services/saving/saving';\nimport $ from 'jquery';\n\nexport default class StatusBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { searchString: '', foundTasks: {} };\n  }\n  search(ev) {\n    if (this.state.searchString === '') {\n      this.searches = { ...window.data.tasks };\n    }\n    this.setState({ searchString: ev.target.value });\n    for (let x of Object.keys(this.searches)) {\n      if (!new RegExp(this.state.searchString, 'i').test(\n        this.searches[x].title) ||\n        this.searches[x].info.complete === 'complete') {\n        delete this.searches[x];\n      }\n    }\n    // id : {title, subtasks, info}\n    this.setState({ foundTasks: this.searches });\n  }\n  goToSearch(id) {\n    window.preventReturn = true;\n    window.preventSelect = true;\n    var idList = [id];\n    function buildParents(otherId) {\n      for (let x of Object.keys(window.data.tasks)) {\n        if (window.data.tasks[util.stripR(x)].subtasks.includes(otherId)) {\n          idList.splice(0, 0, x);\n          buildParents(x);\n          return;\n        }\n      }\n    }\n    buildParents(id);\n    const frame = window.app.current.state[idList[0]].current;\n    const listIndex = frame.state.subtasks.slice(frame.state.shownIndex)\n      .findIndex(x => x === idList[1]);\n    frame.changeIndex(listIndex, true);\n    this.setState({ searchString: '', foundTasks: {} });\n    \n    setTimeout(() => {\n      const list = frame.frames[listIndex].current;\n      let foundTask = list;\n      let i = 2;\n      while (idList.length > i) {\n        // find in tasks starting at index 2 (if it's there)\n        let taskId = idList[i];\n        let taskIndex;\n        if (foundTask.subtasksCurrent &&\n          foundTask.subtasksCurrent.length > 0) {\n          taskIndex = foundTask.subtasksCurrent\n            .findIndex(x => x === taskId);\n        } else {\n          taskIndex = foundTask.state.subtasks\n            .findIndex(x => x === taskId);\n        }\n        foundTask = foundTask.taskList.current\n          .subtaskObjects[taskIndex].current;\n        i++;\n      }\n      window.preventSelect = false;\n      edit.selectTask(foundTask);\n      \n      // go through IDs and find the trace paths\n      setTimeout(() => {\n        window.preventReturn = false;\n      }, 100);\n    }, 100);\n  }\n  componentDidMount() {\n    setTimeout(display.goToToday, 200);\n  }\n  goToFirst() {\n    this.goToSearch($($(this.searchResults.current)\n      .children()[0]).attr('value'));\n  }\n  tutorial = () => {\n    this.setState({ tutorial: true });\n    const myFunc = (ev) => {\n      if (!$(ev.target).hasClass('tutorialShow')) {\n        this.setState({ tutorial: false });\n        $(window).off('click', myFunc);\n      }\n    }\n    setTimeout(() => {\n      $(window).on('click', myFunc)\n    }, 100);\n  }\n  render() {\n    this.search = this.search.bind(this);\n    this.goToSearch = this.goToSearch.bind(this);\n    this.goToFirst = this.goToFirst.bind(this);\n    this.searchResults = React.createRef();\n    this.searchBar = React.createRef();\n    this.options = React.createRef();\n    this.functions = React.createRef();\n    this.move = React.createRef();\n    this.upcoming = React.createRef();\n    let deadlineItems = Object.keys(this.props.deadlines).filter(\n      x => new Date(x).getTime() >= new Date().getTime()\n    )\n    deadlineItems = deadlineItems.map(x => (\n      this.props.deadlines[x].map(y => [x, y])\n    )).flat().filter(x => x.length > 0);\n    this.functionsDict = {\n      'newTask': edit.newTask,\n      'newSubtask': () => edit.newTask(\"task\"),\n      'cutTask': edit.cutTask,\n      'copyTask': edit.copyTask,\n      'copyTaskTrue': () => edit.copyTask(true),\n      'pasteTask': edit.pasteTask,\n      'pasteTaskTask': () => edit.pasteTask('task'),\n      'deleteTask': edit.deleteTask,\n      'moveTaskUp': () => edit.moveTask(-1),\n      'moveTaskDown': () => edit.moveTask(1),\n      'switchView': () => display.switchView(1),\n      'listEditMigrate': () => edit.listEdit('migrate'),\n      'listEditClear': () => edit.listEdit('clear'),\n      'displayTable': display.displayTable,\n      'focus': display.focus,\n      'zoom': display.zoom,\n      'undo': edit.undo,\n      'toggleComplete': () => window.app.current.toggleComplete(),\n      'backup': saving.backup,\n      'restore': saving.restore,\n      'reset': saving.reset,\n      'toggleSounds': display.toggleSounds,\n      'toggleMode': display.toggleMode,\n      'setThemeSpace': () => display.setTheme(\"space\"),\n      'setThemeSky': () => display.setTheme(\"sky\"),\n      'setThemeWater': () => display.setTheme(\"water\"),\n      'setThemeEarth': () => display.setTheme(\"earth\"),\n      'setThemeFire': () => display.setTheme(\"fire\"),\n      'indent': edit.indentTask,\n      'unindent': () => edit.indentTask(true),\n      'togglePast': () => {\n        if (window.app.current.river.state.shownIndex !== 0) {\n          window.app.current.river.setState({\n            shownIndex: 0\n          });\n          display.goToToday();\n        } else {\n          window.app.current.river.setState({\n            shownIndex: window.app.current.river.todayIndex()\n          });\n        }\n      } \n    }\n    return (\n      <>\n      <div className='statusBar'>\n        <span className='title'><span className='r'>River</span>\n          <span className='b'>Bank</span></span>\n        <div style={{\n          display: 'flex', flexDirection: 'column',\n          position: 'relative'\n        }}>\n          <input\n            ref={this.searchBar}\n            className='searchBar' onChange={(ev) => this.search(ev)}\n            value={this.state.searchString}\n            onKeyDown={(ev) => {\n              if (ev.key === 'Backspace') {\n                ev.preventDefault();\n                this.setState({ searchString: '', foundTasks: {} });\n              } else if (ev.key === 'Enter') {\n                ev.preventDefault();\n                if ($(this.searchResults.current).children().length > 0) {\n                  this.goToFirst();\n                }\n              }\n            }}\n            placeholder='search'></input>\n          {this.state.searchString.length > 0 &&\n            <select ref={this.searchResults}\n              style={{ width: '5em' }}\n              onChange={() => {\n                this.goToSearch(this.searchResults.current.value)\n              }}>\n              {Object.keys(this.state.foundTasks).map(x =>\n                <option key={x} value={x}>\n                  {this.state.foundTasks[x].title}\n                </option>)}\n            </select>\n          }\n        </div>\n        <Timer />\n        <div className='buttonBar nowrap'>\n          <select defaultValue='' ref={this.functions} style={{ width: '35px' }}\n            onChange={() => {\n              this.functionsDict[this.functions.current.value].call();\n              this.functions.current.value = '';\n            }}>\n            <option value=\"\" disabled hidden>edit</option>\n            <option value='newTask'>\n              new task (return)</option>\n            <option value='newSubtask'>\n              new subtask (shift-return)</option>\n            <option value='cutTask'>\n              cut (ctrl-x)</option>\n            <option value='copyTask'>\n              copy (ctrl-c)</option>\n            <option value='copyTaskTrue'>\n              mirror (ctrl-shift-C)</option>\n            <option value='pasteTask'>\n              paste (ctrl-v)</option>\n            <option value='pasteTaskTask'>\n              paste as subtask (ctrl-shift-V)</option>\n            <option value=\"deleteTask\">\n              delete (ctrl-delete)</option>\n          </select>\n          <select defaultValue='' ref={this.move} style={{ width: '45px' }}\n            onChange={() => {\n              this.functionsDict[this.move.current.value].call();\n              this.move.current.value = '';\n            }}>\n            <option value=\"\" disabled hidden>move</option>\n            <option value=\"moveTaskUp\">\n              move up (ctrl-w)</option>\n            <option value=\"moveTaskDown\">\n              move down (ctrl-s)</option>\n            <option value=\"indent\">\n              indent (ctrl-])</option>\n            <option value='unindent'>\n              unindent (ctrl-[)</option>\n            <option value=\"switchView\">\n              following week/lists (ctrl-d)</option>\n            <option value=\"switchView(-1)\">\n              previous week/lists (ctrl-a)</option>\n            <option value=\"listEditMigrate\">\n              migrate date</option>\n            <option value=\"listEditClear\">\n              clear list</option>\n            <option value=\"displayTable\">\n              display as table</option>\n            <option value=\"togglePast\">\n              show/hide past dates</option>\n          </select>\n          <select defaultValue='' ref={this.options} onChange={() => {\n            this.functionsDict[this.options.current.value].call();\n            this.options.current.value = '';\n          }}\n            style={{ width: '60px' }}>\n            <option value=\"\" disabled hidden>settings</option>\n            <option value='focus'>focus on list (ctrl-f)</option>\n            <option value='zoom'>focus on view (ctrl-shift-F)</option>\n            <option value='toggleComplete'>\n              show/hide complete (ctrl-h)</option>\n            <option value='undo'>undo (ctrl-z)</option>\n            <option value='backup'>backup</option>\n            <option value='restore'>restore</option>\n            <option value='reset'>reset</option>\n            <option value='toggleSounds'>toggle sounds</option>\n            <option value='toggleMode'>toggle day/night</option>\n            <option value='setThemeSpace'>theme: space</option>\n            <option value='setThemeSky'>theme: sky</option>\n            <option value='setThemeWater'>theme: water</option>\n            <option value='setThemeEarth'>theme: earth</option>\n            <option value='setThemeFire'>theme: fire</option>\n          </select>\n          <ListMenu />\n          <select defaultValue='' ref={this.upcoming} onChange={() => {\n            this.goToSearch(this.upcoming.current.value);\n            this.upcoming.current.value = '';\n          }} style={{width: '75px'}}>\n            <option value=\"\" disabled hidden>upcoming</option>\n            {deadlineItems.map(x => (\n              <option value={util.stripR(x[1])}>\n                {x[0].slice(0, x[0].length - 5)}: {\n                window.data.tasks[util.stripR(x[1])].title}\n              </option>\n            ))}\n          </select>\n        </div>\n        <a className='tutorialLink' onClick={this.tutorial}>help</a>\n      </div>\n      {this.state.tutorial && \n        <div className='tutorial tutorialShow'>\n          <video controls className='tutorialShow'>\n            <source src='../../assets/media/tutorial.mp4'></source>\n          </video>\n        </div>\n      }\n      </>\n    )\n  }\n}\n\nclass ListMenu extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { bankLists: props.bankLists, riverLists: props.riverLists };\n  }\n  goToList(type) {\n    if (type === 'river') {\n      display.searchDate(this.riverLister.current.value);\n    } else if (type === 'bank') {\n      var parent = window.app.current.state.bank.current;\n      var list = this.bankLister;\n      parent.changeIndex(Number(list.current.value), true);\n    }\n\n    if (type === 'river') {\n      this.riverLister.current.value = '';\n    } else if (type === 'bank') {\n      this.bankLister.current.value = '';\n    }\n  }\n  render() {\n    this.riverLister = React.createRef();\n    this.bankLister = React.createRef();\n    return (\n      <>\n        <select defaultValue='' ref={this.bankLister} onChange={() => this.goToList('bank')}\n          style={{ width: '35px' }}>\n          <option value=\"\" disabled hidden>lists</option>\n          {window.data.tasks['bank'].subtasks.filter(\n            x => window.data.tasks[x].title !== '--')\n            .map((x, index) =>\n              <option key={x} value={index}>{window.data.tasks[x].title}</option>)}\n        </select>\n        <select defaultValue='' ref={this.riverLister} onChange={() => {\n          if (this.riverLister.current.value === 'today') {\n            display.goToToday();\n            this.riverLister.current.value = '';\n          } else {\n            this.goToList('river')\n          }\n        }}\n          style={{ width: '45px' }}>\n          <option value=\"\" disabled hidden>dates</option>\n          <option value='today'>today (ctrl-t)</option>\n          {window.data.tasks['river'].subtasks.filter(x => new Date(\n            window.data.tasks[x].title).getTime() >=\n            new Date().getTime())\n            .map((x) =>\n              <option key={x} value={window.data.tasks[x].title}>\n                {window.data.tasks[x].title}</option>)}\n        </select>\n      </>\n    )\n  }\n}\n\nclass Timer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      seconds: 0,\n      audio: new Audio(timerSnd),\n      start: new Audio(startSnd),\n      startTime: undefined,\n      ended: false,\n    };\n\n  }\n  startTimer(val) {\n    const endTime =\n      new Date(new Date().getTime() + val * 60 * 1000).getTime();\n    this.setState({ endTime: endTime, seconds: val * 60 });\n    display.playSound(this.state.start);\n    this.play();\n  }\n  play(stopwatch, backwards) {\n    Notification.requestPermission();\n    clearInterval(this.interval);\n    this.setState({ ended: false });\n    if (stopwatch === 'stopwatch') {\n      display.playSound(this.state.start);\n      this.interval = setInterval(() => {\n        this.setState({ seconds: this.state.seconds + 1 });\n      }, 1000);\n    } else {\n      this.interval = setInterval(() => {\n        this.setState({\n          seconds: Math.ceil((this.state.endTime -\n            new Date().getTime()) / 1000)\n        });\n        if (this.state.seconds <= 0 && this.state.ended === false) {\n          this.end();\n        }\n      }, 1000);\n    }\n  }\n  end() {\n    this.setState({ play: true, ended: true });\n    display.playSound(this.state.audio);\n    this.options.current.value = '';\n    new Notification('timer complete');\n  }\n  playPause() {\n    clearInterval(this.interval);\n    this.setState({ seconds: 0 });\n    this.options.current.value = '';\n  }\n  render() {\n    this.startTimer = this.startTimer.bind(this);\n    this.playPause = this.playPause.bind(this);\n    this.play = this.play.bind(this);\n    this.audioRef = React.createRef();\n    this.options = React.createRef();\n    var timeReadout;\n    if (this.state.seconds >= 0) {\n      timeReadout = Math.floor(this.state.seconds / 60) + ':' +\n        String(this.state.seconds -\n          (Math.floor(this.state.seconds / 60) * 60))\n          .padStart(2, '0')\n    } else {\n      if ((this.state.seconds / 60) === Math.floor(this.state.seconds / 60)\n        && this.state.seconds !== 0) {\n        // right on minute\n        timeReadout = '-' +\n          (-1 * (Math.floor(this.state.seconds / 60))) + ':00'\n      } else {\n        timeReadout = '-' +\n          (-1 * (Math.floor(this.state.seconds / 60) + 1)) + ':' +\n          String(60 - (this.state.seconds -\n            (Math.floor(this.state.seconds / 60) * 60)))\n            .padStart(2, '0')\n      }\n    }\n    return (\n      <>\n        <input className='timerBar' readOnly={true}\n          value={timeReadout}></input>\n        <select value='' ref={this.options} onChange={() => {\n          if (this.options.current.value === 'clear') {\n            this.playPause();\n            this.options.current.value = '';\n          } else if (this.options.current.value === 'stopwatch') {\n            this.setState({ seconds: 0 });\n            this.play('stopwatch');\n            this.options.current.value = '';\n          } else {\n            this.startTimer(this.options.current.value);\n            this.options.current.value = '';\n          }\n        }}\n          style={{ width: '45px' }}>\n          <option value=\"\" disabled hidden>timer</option>\n          <option value={'clear'}>--:--</option>\n          <option value={50}>50:00</option>\n          <option value={25}>25:00</option>\n          <option value={15}>15:00</option>\n          <option value={10}>10:00</option>\n          <option value={5}>5:00</option>\n          <option value={'stopwatch'} title='stopwatch'>&infin;</option>\n        </select>\n      </>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}