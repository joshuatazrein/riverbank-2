{"ast":null,"code":"import _classCallCheck from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./Frame.css';import*as display from'../../services/display/display';import*as util from'../../services/util/util';import List from'../List/List';import $ from'jquery';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Frame=/*#__PURE__*/function(_React$Component){_inherits(Frame,_React$Component);var _super=_createSuper(Frame);function Frame(props){var _this;_classCallCheck(this,Frame);_this=_super.call(this,props);_this.addList=function(){// add a new list\nvar title;if(_this.props.id==='river'){var lastDate=new Date(window.data.tasks[_this.state.subtasks[_this.state.subtasks.length-1]].title);lastDate.setDate(lastDate.getDate()+1);title=lastDate.toDateString();}else{title='--';}var subtasks=_this.state.subtasks;var id=String(new Date().getTime());window.data.tasks[id]={title:title,subtasks:[],info:{}};subtasks.push(id);_this.setState({subtasks:subtasks});};_this.changeIndex=function(val,set){var newIndex;if(set===true){newIndex=val;}else{newIndex=_this.state.info.index+val;}if(!_this.frame)return;var children=$(_this.frame.current).children();console.log(newIndex,children[newIndex]);if(children[newIndex]){children[newIndex].scrollIntoView();}// let newIndex;\n// if (set === true) {\n//   newIndex = val;\n// } else {\n//   newIndex = this.state.info.index + val;\n// }\n// if (newIndex > 0 &&\n//   window.data.tasks[this.state.subtasks[newIndex - 1]].title === '--') {\n//   return;\n// }\n// if (\n//   set !== undefined && \n//   newIndex > this.state.info.index && \n//   this.props.id === 'bank'\n// ) {\n//   newIndex -= (this.state.width - 1);\n// }\n// if (newIndex < 0) newIndex = 0;\n// this.setState(prevState => ({\n//   info: { ...prevState.info, index: newIndex }\n// }));\n};_this.state={subtasks:props.subtasks,info:props.info,width:display.processWidth(props.info.focused),zoomed:''};if(props.id==='river'){_this.state.repeats=window.data.settings.repeats;}var today=new Date();_this.state.shownIndex=_this.state.subtasks.findIndex(function(x){var now=new Date(window.data.tasks[x].title);return now.getDate()===today.getDate()&&now.getMonth()===today.getMonth()&&now.getFullYear()===today.getFullYear();});return _this;}_createClass(Frame,[{key:\"render\",value:function render(){var _this2=this;var resizeCheck=function resizeCheck(){if(_this2.state.width!==display.processWidth(_this2.state.info.focused)){_this2.setState({width:display.processWidth(_this2.state.info.focused)});}};var endIndex=this.state.info.index+this.state.width;this.frames=[];window.addEventListener('resize',resizeCheck);// const shownLists =\n//   this.state.subtasks.slice(this.state.info.index, endIndex);\nvar shownLists=this.state.subtasks.slice(this.state.shownIndex);console.log(shownLists);this.frame=/*#__PURE__*/React.createRef();return/*#__PURE__*/_jsx(\"div\",{className:\"frameContainer \\n        \".concat(this.state.info.focused,\" \").concat(this.state.zoomed),children:/*#__PURE__*/_jsxs(\"div\",{id:this.props.id,className:'frame',ref:this.frame,children:[shownLists.map(function(x){_this2.frames.push(/*#__PURE__*/React.createRef());var task=window.data.tasks[x];if(_this2.props.id==='river'){// render state correctly in original lists\nreturn/*#__PURE__*/_jsx(List,{id:x,title:task.title,subtasks:task.subtasks,parent:_this2,deadlines:_this2.props.deadlines[task.title],startdates:_this2.props.startdates[task.title],repeats:_this2.state.repeats[util.dateFormat(task.title).slice(0,3)],ref:_this2.frames[_this2.frames.length-1]},x);}else{return/*#__PURE__*/_jsx(List,{id:x,title:task.title,subtasks:task.subtasks,parent:_this2,ref:_this2.frames[_this2.frames.length-1]},x);}}),/*#__PURE__*/_jsx(\"button\",{className:\"changeButton\",title:\"add list or date\",onClick:function onClick(){return _this2.addList();},children:\"+\"})]})});}}]);return Frame;}(React.Component);export{Frame as default};","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/components/Frame/Frame.js"],"names":["React","display","util","List","$","Frame","props","addList","title","id","lastDate","Date","window","data","tasks","state","subtasks","length","setDate","getDate","toDateString","String","getTime","info","push","setState","changeIndex","val","set","newIndex","index","frame","children","current","console","log","scrollIntoView","width","processWidth","focused","zoomed","repeats","settings","today","shownIndex","findIndex","x","now","getMonth","getFullYear","resizeCheck","endIndex","frames","addEventListener","shownLists","slice","createRef","map","task","deadlines","startdates","dateFormat","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Frame.css';\nimport * as display from '../../services/display/display';\nimport * as util from '../../services/util/util';\nimport List from '../List/List';\nimport $ from 'jquery';\n\nexport default class Frame extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      subtasks: props.subtasks, info: props.info,\n      width: display.processWidth(props.info.focused),\n      zoomed: '',\n    };\n    if (props.id === 'river') {\n      this.state.repeats = window.data.settings.repeats;\n    }\n    const today = new Date();\n    this.state.shownIndex = this.state.subtasks.findIndex(x => {\n      const now = new Date(window.data.tasks[x].title);\n      return now.getDate() === today.getDate() &&\n        now.getMonth() === today.getMonth() &&\n        now.getFullYear() === today.getFullYear()\n    })\n  }\n  addList = () => {\n    // add a new list\n    var title;\n    if (this.props.id === 'river') {\n      const lastDate = new Date(\n        window.data.tasks[this.state.subtasks[this.state.subtasks.length - 1]].title);\n      lastDate.setDate(lastDate.getDate() + 1);\n      title = lastDate.toDateString();\n    } else {\n      title = '--';\n    }\n\n    const subtasks = this.state.subtasks;\n    const id = String(new Date().getTime());\n    window.data.tasks[id] = {\n      title: title, subtasks: [], info: {}\n    }\n    subtasks.push(id);\n    this.setState({subtasks: subtasks});\n  }\n\n  changeIndex = (val, set) => {\n    var newIndex;\n    if (set === true) {\n      newIndex = val;\n    } else {\n      newIndex = this.state.info.index + val;\n    }\n    if (!this.frame) return;\n    const children = $(this.frame.current).children();\n    console.log(newIndex, children[newIndex]);\n    if (children[newIndex]) {\n      children[newIndex].scrollIntoView();\n    }\n    // let newIndex;\n    // if (set === true) {\n    //   newIndex = val;\n    // } else {\n    //   newIndex = this.state.info.index + val;\n    // }\n    // if (newIndex > 0 &&\n    //   window.data.tasks[this.state.subtasks[newIndex - 1]].title === '--') {\n    //   return;\n    // }\n    // if (\n    //   set !== undefined && \n    //   newIndex > this.state.info.index && \n    //   this.props.id === 'bank'\n    // ) {\n    //   newIndex -= (this.state.width - 1);\n    // }\n    // if (newIndex < 0) newIndex = 0;\n    // this.setState(prevState => ({\n    //   info: { ...prevState.info, index: newIndex }\n    // }));\n  }\n  render() {\n    var resizeCheck = () => {\n      if (this.state.width !== display.processWidth(this.state.info.focused)) {\n        this.setState({ width: display.processWidth(this.state.info.focused) });\n      }\n    }\n    let endIndex = this.state.info.index + this.state.width;\n    this.frames = [];\n    window.addEventListener('resize', resizeCheck);\n    // const shownLists =\n    //   this.state.subtasks.slice(this.state.info.index, endIndex);\n    const shownLists = this.state.subtasks.slice(\n      this.state.shownIndex\n    );\n    console.log(shownLists);\n    this.frame = React.createRef();\n    return (\n      <div className={`frameContainer \n        ${this.state.info.focused} ${this.state.zoomed}`}>\n        <div id={this.props.id}\n          className={'frame'} ref={this.frame}>\n          {shownLists.map(x => {\n            this.frames.push(React.createRef());\n            const task = window.data.tasks[x];\n            if (this.props.id === 'river') {\n              // render state correctly in original lists\n              return (\n                <List key={x} id={x} title={task.title}\n                  subtasks={task.subtasks} parent={this}\n                  deadlines={this.props.deadlines[task.title]}\n                  startdates={this.props.startdates[task.title]}\n                  repeats={this.state.repeats[util.dateFormat(task.title)\n                    .slice(0, 3)]}\n                  ref={this.frames[this.frames.length - 1]} />\n              )\n            } else {\n              return (\n                <List key={x} id={x} title={task.title}\n                  subtasks={task.subtasks} parent={this}\n                  ref={this.frames[this.frames.length - 1]} />\n              )\n            }\n          })}\n          <button className='changeButton' title='add list or date'\n            onClick={() => this.addList()}>+</button>\n        </div>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}