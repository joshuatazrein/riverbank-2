{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _objectSpread from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./Task.css';import $ from'jquery';import*as display from'../../services/display/display';import*as edit from'../../services/edit/edit';import*as util from'../../services/util/util';import TaskList from'../TaskList/TaskList';import List from'../List/List';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Task=/*#__PURE__*/function(_React$Component){_inherits(Task,_React$Component);var _super=_createSuper(Task);function Task(props){var _this;_classCallCheck(this,Task);_this=_super.call(this);_this.hasRepeats=function(){var repeating=false;for(var _i=0,_Object$keys=Object.keys(window.data.settings.repeats);_i<_Object$keys.length;_i++){var repeat=_Object$keys[_i];if(window.data.settings.repeats[repeat].includes('R'+util.stripR(_this.props.id))){repeating=true;break;}}return repeating;};_this.dateRender=function(type){var info;if(type==='start'){info=_this.state.info.startDate.concat();}else if(type==='end'){info=_this.state.info.endDate.concat();}if(_this.state.info.type==='event'){if(type==='start'){var end;if(info[0]>=12)end='p';else end='a';if(info[0]>12){info[0]-=12;}return info[0]+':'+String(info[1]).padStart(2,0)+end;}else if(type==='end'){var string='';if(info[0]!==0)string+=info[0]+'h';if(info[1]!==0)string+=info[1]+'m';return string;}}else if(_this.state.info.type==='date'){return info[0]+'-'+info[1];}};_this.toggleRepeat=function(dayInput,del){var days;if(dayInput==='all'){days=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];}else{days=[dayInput];}var repeatId;if(_this.props.id.charAt(0)==='R'){repeatId=_this.props.id;}else{repeatId='R'+_this.props.id;}var repeats=_objectSpread({},window.app.current.state.river.current.state.repeats);var _iterator=_createForOfIteratorHelper(days),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var day=_step.value;if(repeats[day].includes(repeatId)||del===true){if(repeats[day].includes(repeatId)){repeats[day].splice(repeats[day].findIndex(function(x){return x===repeatId;}),1);}}else{repeats[day].push(repeatId);}}}catch(err){_iterator.e(err);}finally{_iterator.f();}window.app.current.state.river.current.setState({repeats:repeats});edit.saveSetting('repeats',repeats);};_this.timeDrag=function(ev,unit,type){var mouseup=function mouseup(){window.removeEventListener('mousemove',changeTime);window.app.current.setState({disableSelect:''});if(unit==='e'||_this.state.info.type==='event'){_this.displayOptions('hide');}else if(unit==='s'){_this.setState({displayOptions:'show'});}_this.freeze=true;setTimeout(function(){return _this.freeze=false;},200);window.removeEventListener('mouseup',mouseup);_this.props.parent.forceUpdate();};window.addEventListener('mouseup',mouseup);var change=10;var pageY=ev.screenY;var updateTime=function updateTime(ev2,value,unit){var val;var date;var infoOrig;var orig2;if(_this.state.info.type==='event'){if(type==='start'){infoOrig=_this.state.info.startDate[1];orig2=_this.state.info.startDate[0];}else if(type==='end'){infoOrig=_this.state.info.endDate[1];orig2=_this.state.info.endDate[0];}if(infoOrig==='--'){infoOrig=0;}if(orig2==='--'&&type==='end'){orig2=0;}else if(orig2==='--'&&type==='start'){orig2=new Date().getHours();}var _change;if(ev2.shiftKey){_change=value*5;}else{_change=value*30;}val=infoOrig+_change;if(val>=60){val=0;orig2+=1;}else if(val<0){val=60+_change;orig2-=1;}if(type==='end'){if(orig2>=24||orig2<0){val='--';orig2='--';window.removeEventListener('mousemove',changeTime);}}else if(type==='start'){if(orig2==3){val='--';orig2='--';window.removeEventListener('mousemove',changeTime);}}if(type==='start'){_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{startDate:[orig2,val]})});}else if(type==='end'){_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{endDate:[orig2,val]})});}}else{// dates\n_this.updateRiverDate(type,'remove');if(unit==='s'){if(type==='start'){infoOrig=_this.state.info.startDate[0];orig2=_this.state.info.startDate[1];}else if(type==='end'){infoOrig=_this.state.info.endDate[0];orig2=_this.state.info.endDate[1];}if(infoOrig==='--'||Number.isNaN(infoOrig)){infoOrig=new Date().getMonth()+1;}if(orig2==='--'||Number.isNaN(orig2)){orig2=1;}val=infoOrig+value;if(val===new Date().getMonth()&&value<0){val='--';orig2='--';}else{date=new Date();date.setMonth(val-1);val=date.getMonth()+1;}if(type==='start'){_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{startDate:[val,orig2]})});}else if(type==='end'){_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{endDate:[val,orig2]})});}}else if(unit==='e'){if(type==='start'){infoOrig=_this.state.info.startDate[1];orig2=_this.state.info.startDate[0];}else if(type==='end'){infoOrig=_this.state.info.endDate[1];orig2=_this.state.info.endDate[0];}if(infoOrig==='--'||Number.isNaN(infoOrig)){infoOrig=new Date().getDate();}if(orig2==='--'||Number.isNaN(orig2)){orig2=new Date().getMonth()+1;}val=infoOrig+value;date=new Date();date.setMonth(orig2-1);date.setDate(val);date.setHours(0);date.setSeconds(0);date.setMilliseconds(0);var today=new Date();today.setDate(today.getDate()-1);today.setHours(0);today.setSeconds(0);today.setMilliseconds(0);if(date.getTime()===today.getTime()&&value<0){if(type==='start'){_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{startDate:['--','--']})});}else if(type==='end'){_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{endDate:['--','--']})});}return;}if(type==='start'){_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{startDate:[date.getMonth()+1,date.getDate()]})});}else if(type==='end'){_this.setState({info:_objectSpread(_objectSpread({},_this.state.info),{},{endDate:[date.getMonth()+1,date.getDate()]})});}}if(type==='start'&&!_this.state.info.startDate.includes('--')){_this.updateRiverDate(type,'add');}else if(type==='end'&&!_this.state.info.endDate.includes('--')){_this.updateRiverDate(type,'add');}}};var changeTime=function changeTime(ev){var changeTime=false;if(ev.screenY<pageY-change){pageY-=change;changeTime=-1;}else if(ev.screenY>pageY+change){pageY+=change;changeTime=1;}if(changeTime!==false){updateTime(ev,changeTime,unit);}};window.app.current.setState({disableSelect:'disable-select'});window.addEventListener('mousemove',changeTime);};_this.isComplete=function(){var completed=_this.state.info.complete;var parent=_this.props.parent;// hacking completed for repeats\nwhile(!parent instanceof List){parent=parent.props.parent;}if(_this.state.info.excludes.includes(parent.state.title)){completed='complete';}return completed;};_this.dropTask=function(ev,type){if(window.draggedTask.props.id===_this.props.id)return;edit.selectTask(window.draggedTask);var listParent=window.selected.props.parent;edit.cutTask();edit.save(listParent,'list');window.preventSelect=false;setTimeout(function(){edit.selectTask(_assertThisInitialized(_this));if(type==='subtask'){edit.pasteTask('task');}else if(type==='task'){edit.pasteTask();}},100);_this.setState({taskDrop:false,subtaskDrop:false});ev.stopPropagation();};_this.state={info:props.info,title:props.title,subtasks:props.subtasks.filter(function(x){return window.data.tasks[util.stripR(x)];}),parent:props.parent,id:props.id,displayOptions:'hide',riverTask:false,zoomed:'',minHeight:1};// TODO\nif(!_this.state.info.startDate)_this.state.info.startDate=['--','--'];if(!_this.state.info.endDate)_this.state.info.endDate=['--','--'];if(!_this.state.info.notes)_this.state.info.notes='';if(!_this.state.info.type){if(props.parent instanceof List&&util.getFrame(props.parent).props.id==='river'){_this.state.info.type='event';}else{_this.state.info.type='date';}};if(!_this.state.info.collapsed)_this.state.info.collapsed='';if(!_this.state.info.excludes)_this.state.info.excludes=[];return _this;}_createClass(Task,[{key:\"displayOptions\",value:function displayOptions(ev,showHide){edit.save(this);if(this.freeze===true)return;if(window.selected!==this){edit.selectTask(this);}if(this.editBar.current){this.editBar.current.focus();}if($(ev.target).hasClass('options')||$(ev.target).parent().hasClass('options')){return;}if(showHide==='hide'||this.state.displayOptions==='show'){this.setState({displayOptions:'hide'});if(this.props.parent instanceof List&&util.getFrame(this).props.id==='river'){this.props.parent.forceUpdate();}}else if(showHide==='show'||this.state.displayOptions==='hide'){this.setState({displayOptions:'show'});}}},{key:\"changeTitle\",value:function changeTitle(ev){this.setState({title:ev.target.value});this.updateHeight();}},{key:\"updateHeight\",value:function updateHeight(){var _this2=this;if(this.resizable!==false){this.editBar.current.style.height='0px';this.editBar.current.style.height=this.editBar.current.scrollHeight+\"px\";this.resizable=false;}setTimeout(function(){return _this2.resizable=true;},100);}},{key:\"updateRiverDate\",value:function updateRiverDate(type,action){var _this3=this;// remove from startdates/deadlines\nvar date=new Date();var deadlineData;if(type==='start'){if(this.state.info.startDate.includes('--'))return;deadlineData=window.app.current.state.startdates;date.setMonth(this.state.info.startDate[0]-1);date.setDate(this.state.info.startDate[1]);}else if(type==='end'){if(this.state.info.endDate.includes('--'))return;deadlineData=window.app.current.state.deadlines;date.setMonth(this.state.info.endDate[0]-1);date.setDate(this.state.info.endDate[1]);}var dateString=date.toDateString();if(action==='add'){if(!deadlineData[dateString]){deadlineData[dateString]=[this.props.id];}else{deadlineData[dateString].push(this.props.id);}}else if(action==='remove'){if(!deadlineData[dateString])return;else{deadlineData[dateString].splice(deadlineData[dateString].findIndex(function(x){return x===_this3.props.id;}),1);};}// add to the things\nif(type==='start'){window.app.current.setState({startdates:_objectSpread({},deadlineData)});edit.saveSetting('startdates',deadlineData);}else if(type==='end'){window.app.current.setState({deadlines:_objectSpread({},deadlineData)});edit.saveSetting('deadlines',deadlineData);}}},{key:\"toggleComplete\",value:function toggleComplete(change){var status=this.state.info.complete;if(status==='complete'){status='';if(this.state.info.type==='date'){this.updateRiverDate('start','add');this.updateRiverDate('end','add');}}else{status='complete';if(this.state.info.type==='date'){this.updateRiverDate('start','remove');this.updateRiverDate('end','remove');}display.playSound(window.app.current.state.popSnd);}// excludes lets it put it in complete\nvar repeats=window.app.current.state.river.current.state.repeats;var repeating=false;var parent=this.props.parent;/// find list it's in\nwhile(!parent instanceof List){parent=parent.props.parent;}var excludes=this.state.info.excludes;for(var _i2=0,_arr=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];_i2<_arr.length;_i2++){var x=_arr[_i2];if(repeats[x].includes('R'+util.stripR(this.props.id))){repeating=true;if(!excludes.includes(parent.state.title)){excludes.push(parent.state.title);break;}else{excludes.splice(excludes.findIndex(function(x){return x===parent.state.title;}),1);break;}}}if(repeating===true){this.setState({info:_objectSpread(_objectSpread({},this.state.info),{},{excludes:excludes})});}else{this.setState(function(prevState){return{info:_objectSpread(_objectSpread({},prevState.info),{},{complete:status})};});}if(change!==false){this.displayOptions('hide');}}},{key:\"toggleImportant\",value:function toggleImportant(change){var status=this.state.info.important;if(status==='important'){status='';}else{status='important';}this.setState(function(prevState){return{info:_objectSpread(_objectSpread({},prevState.info),{},{important:status,maybe:''})};});if(change!==false){this.displayOptions('hide');}}},{key:\"toggleMaybe\",value:function toggleMaybe(change){var status=this.state.info.maybe;if(status==='maybe'){status='';}else{status='maybe';}this.setState(function(prevState){return{info:_objectSpread(_objectSpread({},prevState.info),{},{maybe:status,important:''})};});if(change!==false){this.displayOptions('hide');}}},{key:\"toggleCollapse\",value:function toggleCollapse(){var status=this.state.info.collapsed;if(status==='collapsed'){status='';}else{status='collapsed';}this.setState(function(prevState){return{info:_objectSpread(_objectSpread({},prevState.info),{},{collapsed:status})};},display.updateAllSizes);this.displayOptions('hide');}},{key:\"deleteThis\",value:function deleteThis(removeData){var _this4=this;if(this.hasRepeats()){var permission=window.confirm('This will delete all repeats.\\n(Complete task to hide only this one)');if(!permission){return;}}// TODO: remove deadline, repeat & startdate \n// [[don't use global variable]]\nvar parent=this.props.parent;while(parent.props.parent){parent=parent.props.parent;}var subtasks=this.state.parent.state.subtasks;var currentTask=subtasks.findIndex(function(x){return x===_this4.props.id;});subtasks.splice(currentTask,1);window.selected=this.state.parent;window.preventSelect=true;this.state.parent.setState({subtasks:subtasks});if(removeData!==false){this.updateRiverDate('start','remove');this.updateRiverDate('end','remove');this.toggleRepeat('all',true);delete window.data.tasks[util.stripR(this.props.id)];}setTimeout(function(){window.undoData=localStorage.getItem('data');window.preventSelect=false;edit.save(_this4.props.parent,'list');},200);}},{key:\"componentDidMount\",value:function componentDidMount(){var _this5=this;this.editBar.current.focus();setTimeout(function(){if(_this5.editBar.current)_this5.updateHeight();},50);edit.selectTask(this);this.resizable=true;}},{key:\"render\",value:function render(){var _this6=this;// fuck react\nthis.displayOptions=this.displayOptions.bind(this);this.toggleComplete=this.toggleComplete.bind(this);this.toggleImportant=this.toggleImportant.bind(this);this.toggleMaybe=this.toggleMaybe.bind(this);this.deleteThis=this.deleteThis.bind(this);this.updateHeight=this.updateHeight.bind(this);this.taskList=/*#__PURE__*/React.createRef();this.optionsButton=/*#__PURE__*/React.createRef();this.editBar=/*#__PURE__*/React.createRef();this.infoInput=/*#__PURE__*/React.createRef();this.infoArea=/*#__PURE__*/React.createRef();var headingClass=this.state.subtasks.length>0?'heading':'';if(this.editBar.current){this.editBar.current.style.height='0px';this.editBar.current.style.height=this.editBar.current.scrollHeight+\"px\";}var parent=this;var id=[];while(parent){id.push(parent.props.id);parent=parent.props.parent;}id=id.reverse().join('-');var hasTimes=this.state.info.type==='event'&&!this.state.info.startDate.includes('--');var repeatsOn={};for(var _i3=0,_arr2=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];_i3<_arr2.length;_i3++){var day=_arr2[_i3];if(window.data.settings.repeats[day].map(function(x){return util.stripR(x);}).includes(util.stripR(this.props.id))){repeatsOn[day]='repeatOn';}else{repeatsOn[day]='';}}var completed=this.isComplete();var amPmFormat=function amPmFormat(hours){if(hours==='--')return hours;if(hours>12)return hours-12;else return hours;};var startExtra;var endExtra;if(this.state.info.type==='event'){// am/pm\nif(!this.state.info.startDate.includes('--')){if(this.state.info.startDate[0]>=12)startExtra='p';else startExtra='a';}}else{// date\nvar getWeekday=function getWeekday(list){var weekdaysDict={1:'M',2:'T',3:'W',4:'R',5:'F',6:'S',0:'U'};var date=new Date();date.setMonth(list[[0]]-1);date.setDate(list[1]);return weekdaysDict[date.getDay()];};if(!this.state.info.startDate.includes('--')){startExtra=getWeekday(this.state.info.startDate);}if(!this.state.info.endDate.includes('--')){endExtra=getWeekday(this.state.info.endDate);}}var openDrag=function openDrag(ev){$(container.current).attr('draggable','true');};var closeDrag=function closeDrag(ev){$(container.current).attr('draggable','false');};var startDrag=function startDrag(ev){// enabling drag & drop: only select target with matching title\n// const dragId = $(ev.target).attr('dragid');\n// if (this.props.id === dragId) {\n// }\n// only drag it if it's possible to be dragged\nconsole.log('startDrag');window.draggedTask=_this6;ev.stopPropagation();};var dragOver=function dragOver(ev){ev.preventDefault();ev.dataTransfer.dropEffect='all';};var container=/*#__PURE__*/React.createRef();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"li\",{className:'task '+this.state.info.important+' '+completed+' '+this.state.info.maybe+' '+headingClass+' '+this.state.info.type+' '+this.state.info.collapsed+' '+this.state.zoomed,onClick:function onClick(){edit.selectTask(_this6);},onContextMenu:function onContextMenu(){return edit.selectTask(_this6);},style:{minHeight:this.state.minHeight*1.15*30},onDragOver:dragOver,children:[/*#__PURE__*/_jsx(\"textarea\",{className:\"infoArea\",ref:this.infoArea,onKeyDown:function onKeyDown(ev){if(ev.key==='Escape'){$(_this6.infoArea.current).hide();setTimeout(function(){return window.preventReturn=false;},100);}},onChange:function onChange(){_this6.setState({info:_objectSpread(_objectSpread({},_this6.state.info),{},{notes:_this6.infoArea.current.value})});},value:this.state.info.notes}),/*#__PURE__*/_jsxs(\"div\",{className:\"taskContent\",ref:container,onDragStart:startDrag,children:[/*#__PURE__*/_jsxs(\"div\",{className:'options '+this.state.displayOptions,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"buttonBar\",style:{width:'100%',justifyContent:'space-around',flexWrap:'nowrap'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"buttonBar\",children:[/*#__PURE__*/_jsx(\"button\",{title:\"toggle complete\",className:'button '+this.state.info.complete,onClick:this.toggleComplete,children:\"\\u221A\"}),/*#__PURE__*/_jsx(\"button\",{title:\"toggle important\",className:'button '+this.state.info.important,onClick:this.toggleImportant,children:\"!\"}),/*#__PURE__*/_jsx(\"button\",{title:\"toggle maybe\",className:'button '+this.state.info.maybe,onClick:this.toggleMaybe,children:\"?\"}),/*#__PURE__*/_jsx(\"button\",{title:\"toggle fold\",className:'button',onClick:function onClick(){return _this6.toggleCollapse();},children:'[]'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttonBar\",children:[/*#__PURE__*/_jsx(\"button\",{className:'button '+repeatsOn['Mon'],onClick:function onClick(){_this6.toggleRepeat('Mon');},children:\"M\"}),/*#__PURE__*/_jsx(\"button\",{className:'button '+repeatsOn['Tue'],onClick:function onClick(){_this6.toggleRepeat('Tue');},children:\"T\"}),/*#__PURE__*/_jsx(\"button\",{className:'button '+repeatsOn['Wed'],onClick:function onClick(){_this6.toggleRepeat('Wed');},children:\"W\"}),/*#__PURE__*/_jsx(\"button\",{className:'button '+repeatsOn['Thu'],onClick:function onClick(){_this6.toggleRepeat('Thu');},children:\"R\"}),/*#__PURE__*/_jsx(\"button\",{className:'button '+repeatsOn['Fri'],onClick:function onClick(){_this6.toggleRepeat('Fri');},children:\"F\"}),/*#__PURE__*/_jsx(\"button\",{className:'button '+repeatsOn['Sat'],onClick:function onClick(){_this6.toggleRepeat('Sat');},children:\"S\"}),/*#__PURE__*/_jsx(\"button\",{className:'button '+repeatsOn['Sun'],onClick:function onClick(){_this6.toggleRepeat('Sun');},children:\"U\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"timeDiv buttonBar\",style:{flexWrap:'nowrap'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"button timeSwitch\",onClick:function onClick(){var changeValue=_this6.state.info.type==='event'?'date':'event';_this6.setState({info:_objectSpread(_objectSpread({},_this6.state.info),{},{type:changeValue,startDate:['--','--'],endDate:['--','--']})});},children:this.state.info.type}),/*#__PURE__*/_jsxs(\"span\",{className:\"startSpan start\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"s\",onMouseDown:function onMouseDown(ev){_this6.timeDrag(ev,'s','start');},children:this.state.info.type==='event'?amPmFormat(this.state.info.startDate[0]):this.state.info.startDate[0]}),/*#__PURE__*/_jsx(\"span\",{className:\"m\",children:this.state.info.type==='event'?':':'/'}),/*#__PURE__*/_jsx(\"span\",{className:\"e\",onMouseDown:function onMouseDown(ev){_this6.timeDrag(ev,'e','start');},children:this.state.info.type==='event'?String(this.state.info.startDate[1]).padStart(2,0):this.state.info.startDate[1]}),startExtra&&/*#__PURE__*/_jsx(\"span\",{className:\"startSpan extraInfo\",children:startExtra})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"startSpan end\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"s\",onMouseDown:function onMouseDown(ev){_this6.timeDrag(ev,'s','end');},children:this.state.info.endDate[0]}),/*#__PURE__*/_jsx(\"span\",{className:\"m\",children:this.state.info.type==='event'?'h':'/'}),/*#__PURE__*/_jsx(\"span\",{className:\"e\",onMouseDown:function onMouseDown(ev){_this6.timeDrag(ev,'e','end');},children:this.state.info.endDate[1]}),/*#__PURE__*/_jsx(\"span\",{children:this.state.info.type==='event'?'m':''}),endExtra&&/*#__PURE__*/_jsx(\"span\",{className:\"startSpan extraInfo\",children:endExtra})]}),/*#__PURE__*/_jsx(\"input\",{ref:this.infoInput,className:\"infoSpan\",placeholder:\"notes\",style:{marginLeft:'5px'},value:this.state.info.notes,onChange:function onChange(){_this6.setState({info:_objectSpread(_objectSpread({},_this6.state.info),{},{notes:_this6.infoInput.current.value})});}}),/*#__PURE__*/_jsx(\"button\",{className:\"button\",onClick:function onClick(){$(_this6.infoArea.current).show();window.preventReturn=true;},title:\"expand notes to paragraph\",children:\"+\"})]})]}),!hasTimes?/*#__PURE__*/_jsx(\"span\",{className:\"info\",onClick:function onClick(ev){return _this6.displayOptions(ev);},ref:this.optionsButton,onMouseDown:openDrag,onMouseUp:closeDrag}):/*#__PURE__*/_jsx(\"span\",{className:\"startDate\",onClick:function onClick(ev){return _this6.displayOptions(ev);},ref:this.optionsButton,onMouseDown:function onMouseDown(ev){_this6.timeDrag(ev,'s','start');},children:this.dateRender('start')}),/*#__PURE__*/_jsx(\"textarea\",{className:\"editBar\",value:this.state.title,onChange:function onChange(ev){return _this6.changeTitle(ev);},ref:this.editBar,spellCheck:\"false\",onClick:function onClick(ev){return _this6.displayOptions(ev,'hide');}}),this.state.info.notes.length===0&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',marginRight:'5px'},children:[!hasTimes&&!this.state.info.startDate.includes('--')&&/*#__PURE__*/_jsx(\"span\",{className:\"startDate\",children:this.dateRender('start')}),!this.state.info.endDate.includes('--')&&/*#__PURE__*/_jsx(\"span\",{className:\"endDate\",children:this.dateRender('end')})]})]}),this.state.info.notes.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"taskInfo\",children:[this.state.info.notes.length>0&&/*#__PURE__*/_jsx(\"span\",{className:\"notesSpan\",children:this.state.info.notes.length>50?this.state.info.notes.slice(0,50)+'...':this.state.info.notes}),!hasTimes&&!this.state.info.startDate.includes('--')&&/*#__PURE__*/_jsx(\"span\",{className:\"startDate\",children:this.dateRender('start')}),!this.state.info.endDate.includes('--')&&/*#__PURE__*/_jsx(\"span\",{className:\"endDate\",children:this.dateRender('end')})]}),/*#__PURE__*/_jsx(\"div\",{className:\"dropArea \".concat(this.state.subtaskDrop?'droppable':''),onDragEnter:function onDragEnter(){console.log(window.draggedTask.props.id);if(window.draggedTask.props.id===_this6.props.id)return;_this6.setState({subtaskDrop:true});},onDragLeave:function onDragLeave(){return _this6.setState({subtaskDrop:false});},onDrop:function onDrop(ev){return _this6.dropTask(ev,'subtask');}}),/*#__PURE__*/_jsx(TaskList,{ref:this.taskList,subtasks:this.state.subtasks,parent:this})]}),/*#__PURE__*/_jsx(\"div\",{className:\"dropArea \".concat(this.state.taskDrop?'droppable':'',\"\\n          \").concat(completed),onDragEnter:function onDragEnter(){console.log(window.draggedTask.props.id);if(window.draggedTask.props.id===_this6.props.id)return;_this6.setState({taskDrop:true});},onDragLeave:function onDragLeave(){return _this6.setState({taskDrop:false});},onDrop:function onDrop(ev){return _this6.dropTask(ev,'task');},onDragOver:dragOver})]});}}]);return Task;}(React.Component);export{Task as default};","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/components/Task/Task.js"],"names":["React","$","display","edit","util","TaskList","List","Task","props","hasRepeats","repeating","Object","keys","window","data","settings","repeats","repeat","includes","stripR","id","dateRender","type","info","state","startDate","concat","endDate","end","String","padStart","string","toggleRepeat","dayInput","del","days","repeatId","charAt","app","current","river","day","splice","findIndex","x","push","setState","saveSetting","timeDrag","ev","unit","mouseup","removeEventListener","changeTime","disableSelect","displayOptions","freeze","setTimeout","parent","forceUpdate","addEventListener","change","pageY","screenY","updateTime","ev2","value","val","date","infoOrig","orig2","Date","getHours","shiftKey","updateRiverDate","Number","isNaN","getMonth","setMonth","getDate","setDate","setHours","setSeconds","setMilliseconds","today","getTime","isComplete","completed","complete","excludes","title","dropTask","draggedTask","selectTask","listParent","selected","cutTask","save","preventSelect","pasteTask","taskDrop","subtaskDrop","stopPropagation","subtasks","filter","tasks","riverTask","zoomed","minHeight","notes","getFrame","collapsed","showHide","editBar","focus","target","hasClass","updateHeight","resizable","style","height","scrollHeight","action","deadlineData","startdates","deadlines","dateString","toDateString","status","playSound","popSnd","prevState","important","maybe","updateAllSizes","removeData","permission","confirm","currentTask","undoData","localStorage","getItem","bind","toggleComplete","toggleImportant","toggleMaybe","deleteThis","taskList","createRef","optionsButton","infoInput","infoArea","headingClass","length","reverse","join","hasTimes","repeatsOn","map","amPmFormat","hours","startExtra","endExtra","getWeekday","list","weekdaysDict","getDay","openDrag","container","attr","closeDrag","startDrag","console","log","dragOver","preventDefault","dataTransfer","dropEffect","key","hide","preventReturn","width","justifyContent","flexWrap","toggleCollapse","changeValue","marginLeft","show","changeTitle","flexDirection","marginRight","slice","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './Task.css';\nimport $ from 'jquery';\nimport * as display from '../../services/display/display';\nimport * as edit from '../../services/edit/edit';\nimport * as util from '../../services/util/util';\nimport TaskList from '../TaskList/TaskList';\nimport List from '../List/List';\n\nexport default class Task extends React.Component {\n  constructor(props) {\n    super();\n    this.state = {\n      info: props.info, title: props.title,\n      subtasks: props.subtasks.filter(x =>\n        window.data.tasks[util.stripR(x)]), parent: props.parent,\n      id: props.id, displayOptions: 'hide', riverTask: false,\n      zoomed: '', minHeight: 1\n    };\n    // TODO\n    if (!this.state.info.startDate) this.state.info.startDate = ['--', '--'];\n    if (!this.state.info.endDate) this.state.info.endDate = ['--', '--'];\n    if (!this.state.info.notes) this.state.info.notes = '';\n    if (!this.state.info.type) {\n      if (props.parent instanceof List &&\n        util.getFrame(props.parent).props.id === 'river') {\n        this.state.info.type = 'event';\n      } else {\n        this.state.info.type = 'date';\n      }\n    };\n    if (!this.state.info.collapsed) this.state.info.collapsed = '';\n    if (!this.state.info.excludes) this.state.info.excludes = [];\n  }\n  displayOptions(ev, showHide) {\n    edit.save(this);\n    if (this.freeze === true) return;\n    if (window.selected !== this) {\n      edit.selectTask(this);\n    }\n    if (this.editBar.current) {\n      this.editBar.current.focus();\n    }\n    if ($(ev.target).hasClass('options') ||\n      $(ev.target).parent().hasClass('options')) {\n      return\n    }\n    if (showHide === 'hide' || this.state.displayOptions === 'show') {\n      this.setState({ displayOptions: 'hide' });\n      if (\n        this.props.parent instanceof List && \n        util.getFrame(this).props.id === 'river'\n      ) {\n        this.props.parent.forceUpdate();\n      }\n    } else if (showHide === 'show' || this.state.displayOptions === 'hide') {\n      this.setState({ displayOptions: 'show' });\n    }\n  }\n  changeTitle(ev) {\n    this.setState({ title: ev.target.value });\n    this.updateHeight();\n  }\n  updateHeight() {\n    if (this.resizable !== false) {\n      this.editBar.current.style.height = '0px';\n      this.editBar.current.style.height =\n        (this.editBar.current.scrollHeight) + \"px\";\n      this.resizable = false;\n    }\n    setTimeout(() => this.resizable = true, 100);\n  }\n  updateRiverDate(type, action) {\n    // remove from startdates/deadlines\n    var date = new Date();\n    var deadlineData;\n    if (type === 'start') {\n      if (this.state.info.startDate.includes('--')) return;\n      deadlineData = window.app.current.state.startdates;\n      date.setMonth(this.state.info.startDate[0] - 1);\n      date.setDate(this.state.info.startDate[1]);\n    } else if (type === 'end') {\n      if (this.state.info.endDate.includes('--')) return;\n      deadlineData = window.app.current.state.deadlines;\n      date.setMonth(this.state.info.endDate[0] - 1);\n      date.setDate(this.state.info.endDate[1]);\n    }\n    var dateString = date.toDateString();\n    if (action === 'add') {\n      if (!deadlineData[dateString]) {\n        deadlineData[dateString] = [this.props.id]\n      }\n      else { deadlineData[dateString].push(this.props.id) }\n    } else if (action === 'remove') {\n      if (!deadlineData[dateString]) return\n      else {\n        deadlineData[dateString].splice(deadlineData[dateString].findIndex(\n          x => x === this.props.id), 1)\n      };\n    }\n    // add to the things\n    if (type === 'start') {\n      window.app.current.setState({ startdates: { ...deadlineData } });\n      edit.saveSetting('startdates', deadlineData);\n    } else if (type === 'end') {\n      window.app.current.setState({ deadlines: { ...deadlineData } });\n      edit.saveSetting('deadlines', deadlineData);\n    }\n  }\n  toggleComplete(change) {\n    let status = this.state.info.complete\n    if (status === 'complete') { \n      status = '';\n      if (this.state.info.type === 'date') {\n        this.updateRiverDate('start', 'add');\n        this.updateRiverDate('end', 'add');\n      }\n    }\n    else {\n      status = 'complete';\n      if (this.state.info.type === 'date') {\n        this.updateRiverDate('start', 'remove');\n        this.updateRiverDate('end', 'remove');\n      }\n      display.playSound(window.app.current.state.popSnd);\n    }\n    // excludes lets it put it in complete\n    const repeats = window.app.current.state.river.current.state.repeats;\n    let repeating = false;\n    let parent = this.props.parent; /// find list it's in\n    while (!parent instanceof List) {\n      parent = parent.props.parent;\n    }\n    const excludes = this.state.info.excludes;\n    for (let x of ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']) {\n      if (repeats[x].includes('R' + util.stripR(this.props.id))) {\n        repeating = true;\n        if (!excludes.includes(parent.state.title)) {\n          excludes.push(parent.state.title);\n          break;\n        } else {\n          excludes.splice(excludes\n            .findIndex(x => x === parent.state.title), 1);\n          break;\n        }\n      }\n    }\n    if (repeating === true) {\n      this.setState({ info: { ...this.state.info, excludes: excludes } })\n    } else {\n      this.setState(prevState => ({\n        info: { ...prevState.info, complete: status }\n      }));\n    }\n    if (change !== false) {\n      this.displayOptions('hide');\n    }\n  }\n  toggleImportant(change) {\n    let status = this.state.info.important\n    if (status === 'important') { status = '' }\n    else { status = 'important' }\n    this.setState(prevState => ({\n      info: { ...prevState.info, important: status, maybe: '' }\n    }));\n    if (change !== false) {\n      this.displayOptions('hide');\n    }\n  }\n  toggleMaybe(change) {\n    let status = this.state.info.maybe\n    if (status === 'maybe') { status = '' }\n    else { status = 'maybe' }\n    this.setState(prevState => ({\n      info: { ...prevState.info, maybe: status, important: '' }\n    }));\n    if (change !== false) {\n      this.displayOptions('hide');\n    }\n  }\n  toggleCollapse() {\n    let status = this.state.info.collapsed\n    if (status === 'collapsed') { status = '' }\n    else { status = 'collapsed' }\n    this.setState(prevState => ({\n      info: { ...prevState.info, collapsed: status }\n    }), display.updateAllSizes);\n    this.displayOptions('hide');\n  }\n  hasRepeats = () => {\n    let repeating = false;\n    for (let repeat of Object.keys(window.data.settings.repeats)) {\n      if (window.data.settings.repeats[repeat].includes('R' +\n        util.stripR(this.props.id))) {\n        repeating = true;\n        break;\n      }\n    }\n    return repeating;\n  }\n  deleteThis(removeData) {\n    if (this.hasRepeats()) {\n      const permission = window.confirm(\n        'This will delete all repeats.\\n(Complete task to hide only this one)');\n      if (!permission) { return; }\n    }\n    // TODO: remove deadline, repeat & startdate \n    // [[don't use global variable]]\n    let parent = this.props.parent;\n    while (parent.props.parent) {\n      parent = parent.props.parent;\n    }\n    const subtasks = this.state.parent.state.subtasks;\n    const currentTask = subtasks.findIndex(x => x === this.props.id);\n    subtasks.splice(currentTask, 1);\n    window.selected = this.state.parent;\n    window.preventSelect = true;\n    this.state.parent.setState({ subtasks: subtasks });\n    if (removeData !== false) {\n      this.updateRiverDate('start', 'remove');\n      this.updateRiverDate('end', 'remove');\n      this.toggleRepeat('all', true);\n      delete window.data.tasks[util.stripR(this.props.id)];\n    }\n    setTimeout(() => {\n      window.undoData = localStorage.getItem('data');\n      window.preventSelect = false\n      edit.save(this.props.parent, 'list');\n    }, 200);\n  }\n  componentDidMount() {\n    this.editBar.current.focus();\n    setTimeout(\n      () => {\n        if (this.editBar.current) this.updateHeight();\n      }, 50\n    )\n    edit.selectTask(this);\n    this.resizable = true;\n  }\n  dateRender = (type) => {\n    var info;\n    if (type === 'start') {\n      info = this.state.info.startDate.concat();\n    } else if (type === 'end') {\n      info = this.state.info.endDate.concat();\n    }\n    if (this.state.info.type === 'event') {\n      if (type === 'start') {\n        let end;\n        if (info[0] >= 12) end = 'p';\n        else end = 'a';\n        if (info[0] > 12) { info[0] -= 12 }\n        return info[0] + ':' + String(info[1]).padStart(2, 0) + end;\n      } else if (type === 'end') {\n        let string = '';\n        if (info[0] !== 0) string += info[0] + 'h';\n        if (info[1] !== 0) string += info[1] + 'm';\n        return string;\n      }\n    } else if (this.state.info.type === 'date') {\n      return info[0] + '-' + info[1];\n    }\n  }\n  toggleRepeat = (dayInput, del) => {\n    var days;\n    if (dayInput === 'all') {\n      days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];\n    } else {\n      days = [dayInput];\n    }\n    let repeatId;\n    if (this.props.id.charAt(0) === 'R') {\n      repeatId = this.props.id;\n    } else {\n      repeatId = 'R' + this.props.id;\n    }\n    const repeats = { ...window.app.current.state.river.current.state.repeats };\n    for (let day of days) {\n      if (repeats[day].includes(repeatId) || del === true) {\n        if (repeats[day].includes(repeatId)) {\n          repeats[day].splice(repeats[day]\n            .findIndex(x => x === repeatId), 1);\n        }\n      } else {\n        repeats[day].push(repeatId);\n      }\n    }\n    window.app.current.state.river.current.setState({\n      repeats: repeats\n    });\n    edit.saveSetting('repeats', repeats);\n  }\n  timeDrag = (ev, unit, type) => {\n    var mouseup = () => {\n      window.removeEventListener('mousemove', changeTime);\n      window.app.current.setState({ disableSelect: '' });\n      if (unit === 'e' || this.state.info.type === 'event') {\n        this.displayOptions('hide');\n      } else if (unit === 's') {\n        this.setState({ displayOptions: 'show' });\n      } \n      this.freeze = true;\n      setTimeout(() => this.freeze = false, 200);\n      window.removeEventListener('mouseup', mouseup);\n      this.props.parent.forceUpdate();\n    }\n    window.addEventListener('mouseup', mouseup);\n    var change = 10;\n    var pageY = ev.screenY;\n    var updateTime = (ev2, value, unit) => {\n      let val;\n      let date;\n      let infoOrig;\n      let orig2;\n      if (this.state.info.type === 'event') {\n        if (type === 'start') {\n          infoOrig = this.state.info.startDate[1];\n          orig2 = this.state.info.startDate[0];\n        } else if (type === 'end') {\n          infoOrig = this.state.info.endDate[1];\n          orig2 = this.state.info.endDate[0];\n        }\n        if (infoOrig === '--') {\n          infoOrig = 0;\n        }\n        if (orig2 === '--' && type === 'end') {\n          orig2 = 0;\n        } else if (orig2 === '--' && type === 'start') {\n          orig2 = new Date().getHours();\n        }\n        let change;\n        if (ev2.shiftKey) {\n          change = value * 5;\n        } else {\n          change = value * 30;\n        }\n        val = infoOrig + change;\n        if (val >= 60) {\n          val = 0;\n          orig2 += 1;\n        } else if (val < 0) {\n          val = 60 + change;\n          orig2 -= 1;\n        }\n        if (type === 'end') {\n          if (orig2 >= 24 || orig2 < 0) {\n            val = '--';\n            orig2 = '--';\n            window.removeEventListener('mousemove', changeTime);\n          }\n        } else if (type === 'start') {\n          if (orig2 == 3) {\n            val = '--';\n            orig2 = '--';\n            window.removeEventListener('mousemove', changeTime);\n          }\n        }\n        if (type === 'start') {\n          this.setState({\n            info: {\n              ...this.state.info,\n              startDate: [orig2, val]\n            }\n          });\n        } else if (type === 'end') {\n          this.setState({\n            info: {\n              ...this.state.info,\n              endDate: [orig2, val]\n            }\n          });\n        }\n      } else {\n        // dates\n        this.updateRiverDate(type, 'remove');\n        if (unit === 's') {\n          if (type === 'start') {\n            infoOrig = this.state.info.startDate[0];\n            orig2 = this.state.info.startDate[1];\n          } else if (type === 'end') {\n            infoOrig = this.state.info.endDate[0];\n            orig2 = this.state.info.endDate[1];\n          }\n          if (infoOrig === '--' || Number.isNaN(infoOrig)) {\n            infoOrig = new Date().getMonth() + 1;\n          }\n          if (orig2 === '--' || Number.isNaN(orig2)) {\n            orig2 = 1;\n          }\n          val = infoOrig + value;\n          if (val === new Date().getMonth() && value < 0) {\n            val = '--';\n            orig2 = '--';\n          } else {\n            date = new Date();\n            date.setMonth(val - 1);\n            val = date.getMonth() + 1;\n          }\n          if (type === 'start') {\n            this.setState({\n              info: {\n                ...this.state.info,\n                startDate: [val, orig2]\n              }\n            });\n          } else if (type === 'end') {\n            this.setState({\n              info: {\n                ...this.state.info,\n                endDate: [val, orig2]\n              }\n            });\n          }\n        } else if (unit === 'e') {\n          if (type === 'start') {\n            infoOrig = this.state.info.startDate[1];\n            orig2 = this.state.info.startDate[0];\n          } else if (type === 'end') {\n            infoOrig = this.state.info.endDate[1];\n            orig2 = this.state.info.endDate[0];\n          }\n          if (infoOrig === '--' || Number.isNaN(infoOrig)) {\n            infoOrig = new Date().getDate();\n          }\n          if (orig2 === '--' || Number.isNaN(orig2)) {\n            orig2 = new Date().getMonth() + 1;\n          }\n          val = infoOrig + value;\n          date = new Date();\n          date.setMonth(orig2 - 1);\n          date.setDate(val);\n          date.setHours(0); date.setSeconds(0); date.setMilliseconds(0);\n          const today = new Date();\n          today.setDate(today.getDate() - 1);\n          today.setHours(0); today.setSeconds(0); today.setMilliseconds(0);\n          if (date.getTime() === today.getTime() && value < 0) {\n            if (type === 'start') {\n              this.setState({\n                info: {\n                  ...this.state.info,\n                  startDate: ['--', '--']\n                }\n              });\n            } else if (type === 'end') {\n              this.setState({\n                info: {\n                  ...this.state.info,\n                  endDate: ['--', '--']\n                }\n              });\n            }\n            return;\n          }\n          if (type === 'start') {\n            this.setState({\n              info: {\n                ...this.state.info,\n                startDate: [date.getMonth() + 1, date.getDate()]\n              }\n            });\n          } else if (type === 'end') {\n            this.setState({\n              info: {\n                ...this.state.info,\n                endDate: [date.getMonth() + 1, date.getDate()]\n              }\n            });\n          }\n        }\n        if (type === 'start' && !this.state.info.startDate.includes('--')) {\n          this.updateRiverDate(type, 'add');\n        } else if (type === 'end' && !this.state.info.endDate.includes('--')) {\n          this.updateRiverDate(type, 'add');\n        }\n      }\n    }\n    var changeTime = (ev) => {\n      var changeTime = false;\n      if (ev.screenY < pageY - change) {\n        pageY -= change;\n        changeTime = -1;\n      } else if (ev.screenY > pageY + change) {\n        pageY += change;\n        changeTime = 1;\n      }\n      if (changeTime !== false) {\n        updateTime(ev, changeTime, unit);\n      }\n    }\n    window.app.current.setState({ disableSelect: 'disable-select' });\n    window.addEventListener('mousemove', changeTime);\n  }\n  isComplete = () => {\n    let completed = this.state.info.complete;\n    let parent = this.props.parent;\n    // hacking completed for repeats\n    while (!parent instanceof List) {\n      parent = parent.props.parent;\n    }\n    if (this.state.info.excludes.includes(parent.state.title)) {\n      completed = 'complete';\n    }\n    return completed;\n  }\n  dropTask = (ev, type) => {\n    if (window.draggedTask.props.id === this.props.id) return;\n    edit.selectTask(window.draggedTask);\n    const listParent = window.selected.props.parent;\n    edit.cutTask();\n    edit.save(listParent, 'list');\n    window.preventSelect = false;\n    setTimeout(() => {\n      edit.selectTask(this);\n      if (type === 'subtask') {\n        edit.pasteTask('task');\n      } else if (type === 'task') {\n        edit.pasteTask();\n      }\n    }, 100);\n    this.setState({\n      taskDrop: false,\n      subtaskDrop: false,\n    })\n    ev.stopPropagation();\n  }\n  render() {\n    // fuck react\n    this.displayOptions = this.displayOptions.bind(this);\n    this.toggleComplete = this.toggleComplete.bind(this);\n    this.toggleImportant = this.toggleImportant.bind(this);\n    this.toggleMaybe = this.toggleMaybe.bind(this);\n    this.deleteThis = this.deleteThis.bind(this);\n    this.updateHeight = this.updateHeight.bind(this);\n    this.taskList = React.createRef();\n    this.optionsButton = React.createRef();\n    this.editBar = React.createRef();\n    this.infoInput = React.createRef();\n    this.infoArea = React.createRef();\n    const headingClass = this.state.subtasks.length > 0 ?\n      'heading' : '';\n    if (this.editBar.current) {\n      this.editBar.current.style.height = '0px';\n      this.editBar.current.style.height =\n        (this.editBar.current.scrollHeight) + \"px\";\n    }\n    let parent = this;\n    let id = [];\n    while (parent) {\n      id.push(parent.props.id);\n      parent = parent.props.parent;\n    }\n    id = id.reverse().join('-');\n    const hasTimes = this.state.info.type === 'event' &&\n      !this.state.info.startDate.includes('--');\n    let repeatsOn = {};\n    for (let day of ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']) {\n      if (window.data.settings.repeats[day].map(x => util.stripR(x)).includes(\n        util.stripR(this.props.id))) {\n        repeatsOn[day] = 'repeatOn';\n      } else {\n        repeatsOn[day] = '';\n      }\n    }\n    let completed = this.isComplete();\n    const amPmFormat = (hours) => {\n      if (hours === '--') return hours;\n      if (hours > 12) return hours - 12;\n      else return hours;\n    }\n    let startExtra;\n    let endExtra;\n    if (this.state.info.type === 'event') {\n      // am/pm\n      if (!this.state.info.startDate.includes('--')) {\n        if (this.state.info.startDate[0] >= 12) startExtra = 'p';\n        else startExtra = 'a';\n      }\n    }\n    else {\n      // date\n      const getWeekday = (list) => {\n        const weekdaysDict = {\n          1: 'M', 2: 'T', 3: 'W', 4: 'R', 5: 'F', 6: 'S', 0: 'U'\n        };\n        const date = new Date();\n        date.setMonth(list[[0]] - 1);\n        date.setDate(list[1]);\n        return weekdaysDict[date.getDay()];\n      }\n      if (!this.state.info.startDate.includes('--')) {\n        startExtra = getWeekday(this.state.info.startDate);\n      }\n      if (!this.state.info.endDate.includes('--')) {\n        endExtra = getWeekday(this.state.info.endDate);\n      }\n    } \n    const openDrag = (ev) => {\n      $(container.current).attr('draggable', 'true');\n    }\n    const closeDrag = (ev) => {\n      $(container.current).attr('draggable', 'false');\n    }\n    const startDrag = (ev) => {\n      // enabling drag & drop: only select target with matching title\n      // const dragId = $(ev.target).attr('dragid');\n      // if (this.props.id === dragId) {\n      // }\n      // only drag it if it's possible to be dragged\n      console.log('startDrag');\n      window.draggedTask = this;\n      ev.stopPropagation();\n    }\n    const dragOver = (ev) => {\n      ev.preventDefault();\n      ev.dataTransfer.dropEffect = 'all';\n    }\n    const container = React.createRef();\n    return (\n      <>\n      <li className={'task ' + this.state.info.important +\n        ' ' + completed +\n        ' ' + this.state.info.maybe +\n        ' ' + headingClass +\n        ' ' + this.state.info.type +\n        ' ' + this.state.info.collapsed +\n        ' ' + this.state.zoomed}\n        onClick={() => { edit.selectTask(this) }} \n        onContextMenu={() => edit.selectTask(this) }\n        style={{minHeight: this.state.minHeight * 1.15 * 30}}\n        onDragOver={dragOver}\n      >\n        <textarea className='infoArea' \n        ref={this.infoArea}\n        onKeyDown={(ev) => {\n          if (ev.key === 'Escape') {\n            $(this.infoArea.current).hide();\n            setTimeout(() => window.preventReturn = false, 100);\n          }\n        }}\n        onChange={() => {\n          this.setState({\n            info: {\n              ...this.state.info,\n              notes: this.infoArea.current.value\n            }\n          })\n        }}\n        value={this.state.info.notes}\n        ></textarea>\n        <div className='taskContent' ref={container}\n          onDragStart={startDrag}>\n          <div className={'options ' + this.state.displayOptions}>\n            <div className='buttonBar' style={{\n              width: '100%',\n              justifyContent: 'space-around',\n              flexWrap: 'nowrap',\n            }}>\n              <div className='buttonBar'>\n                <button\n                  title='toggle complete'\n                  className={'button ' + this.state.info.complete}\n                  onClick={this.toggleComplete}>\n                  √</button>\n                <button\n                  title='toggle important'\n                  className={'button ' + this.state.info.important}\n                  onClick={this.toggleImportant}>\n                  !</button>\n                <button\n                  title='toggle maybe'\n                  className={'button ' + this.state.info.maybe}\n                  onClick={this.toggleMaybe}>\n                  ?</button>\n                <button\n                  title='toggle fold'\n                  className={'button'}\n                  onClick={() => this.toggleCollapse()}>\n                  {'[]'}</button>\n              </div>\n              <div className='buttonBar'>\n                <button className={'button ' + repeatsOn['Mon']}\n                  onClick={() => { this.toggleRepeat('Mon'); }}>M</button>\n                <button className={'button ' + repeatsOn['Tue']}\n                  onClick={() => {\n                    this.toggleRepeat('Tue');\n                  }}>T</button>\n                <button className={'button ' + repeatsOn['Wed']}\n                  onClick={() => {\n                    this.toggleRepeat('Wed');\n                  }}>W</button>\n                <button className={'button ' + repeatsOn['Thu']}\n                  onClick={() => {\n                    this.toggleRepeat('Thu');\n                  }}>R</button>\n                <button className={'button ' + repeatsOn['Fri']}\n                  onClick={() => {\n                    this.toggleRepeat('Fri');\n                  }}>F</button>\n                <button className={'button ' + repeatsOn['Sat']}\n                  onClick={() => {\n                    this.toggleRepeat('Sat');\n                  }}>S</button>\n                <button className={'button ' + repeatsOn['Sun']}\n                  onClick={() => {\n                    this.toggleRepeat('Sun');\n                  }}>U</button>\n              </div>\n            </div>\n              <div className='timeDiv buttonBar' style={{\n                flexWrap: 'nowrap',\n              }}>\n                <button className='button timeSwitch'\n                  onClick={() => {\n                    var changeValue = this.state.info.type === 'event' ?\n                      'date' : 'event';\n                    this.setState({\n                      info: {\n                        ...this.state.info,\n                        type: changeValue,\n                        startDate: ['--', '--'],\n                        endDate: ['--', '--'],\n                      }\n                    })\n                  }}>\n                  {this.state.info.type}\n                </button>\n                <span className='startSpan start'>\n                  <span className='s' onMouseDown={(ev) => {\n                    this.timeDrag(ev, 's', 'start');\n                  }}>{\n                    this.state.info.type === 'event' ?\n                      amPmFormat(this.state.info.startDate[0]) :\n                      this.state.info.startDate[0]\n                  }</span>\n                  <span className='m'>{\n                    this.state.info.type === 'event' ? ':' : '/'\n                  }</span>\n                  <span \n                    className='e' \n                    onMouseDown={(ev) => {\n                      this.timeDrag(ev, 'e', 'start');\n                    }}\n                  >\n                    {this.state.info.type === 'event' ?\n                      String(this.state.info.startDate[1]).padStart(2, 0) :\n                      this.state.info.startDate[1]\n                    }\n                  </span>\n                  {startExtra && \n                  <span className='startSpan extraInfo'>\n                    {startExtra}\n                  </span>}\n                </span>\n                <span className='startSpan end'>\n                  <span className='s' onMouseDown={(ev) => {\n                    this.timeDrag(ev, 's', 'end');\n                  }}>{this.state.info.endDate[0]}</span>\n                  <span className='m'>{\n                    this.state.info.type === 'event' ? 'h' : '/'\n                  }</span>\n                  <span className='e' onMouseDown={(ev) => {\n                    this.timeDrag(ev, 'e', 'end');\n                  }}>{this.state.info.endDate[1]}</span>\n                  <span>{this.state.info.type === 'event' ?\n                    'm' : ''}</span>\n                  {endExtra && \n                  <span className='startSpan extraInfo'>\n                    {endExtra}\n                  </span>}\n                </span>\n                <input ref={this.infoInput} className='infoSpan' placeholder='notes'\n                  style={{ marginLeft: '5px' }}\n                  value={this.state.info.notes}\n                  onChange={() => {\n                    this.setState({\n                      info: {\n                        ...this.state.info,\n                        notes: this.infoInput.current.value\n                      }\n                    })\n                  }}></input>\n                <button className='button' onClick={() => {\n                  $(this.infoArea.current).show();\n                  window.preventReturn = true;\n                }} title='expand notes to paragraph'>+</button>\n              </div>\n          </div>\n          {!hasTimes ? \n            <span className='info'\n              onClick={(ev) => this.displayOptions(ev)}\n              ref={this.optionsButton}\n              onMouseDown={openDrag}\n              onMouseUp={closeDrag}>\n            </span> :\n            <span className='startDate'\n              onClick={(ev) => this.displayOptions(ev)}\n              ref={this.optionsButton}\n              onMouseDown={(ev) => {\n                this.timeDrag(ev, 's', 'start')\n              }}>\n              {this.dateRender('start')}\n            </span>}\n          <textarea className='editBar' value={this.state.title}\n            onChange={(ev) => this.changeTitle(ev)} ref={this.editBar}\n            spellCheck='false' onClick={(ev) => this.displayOptions(ev, 'hide')}></textarea>\n          {this.state.info.notes.length === 0 &&\n            <div style={{\n              display: 'flex', flexDirection: 'column',\n              marginRight: '5px'\n            }}>\n              {!hasTimes &&\n                !this.state.info.startDate.includes('--') &&\n                <span className='startDate'>\n                  {this.dateRender('start')}\n                </span>}\n              {!this.state.info.endDate.includes('--') &&\n                <span className='endDate'>\n                  {this.dateRender('end')}\n                </span>}\n            </div>\n          }\n        </div>\n        {this.state.info.notes.length > 0 &&\n        <div className='taskInfo'>\n          {this.state.info.notes.length > 0 &&\n            <span className='notesSpan'>\n              {this.state.info.notes.length > 50 ?\n                this.state.info.notes.slice(0, 50) + '...' :\n                this.state.info.notes}\n            </span>}\n          {!hasTimes &&\n            !this.state.info.startDate.includes('--') &&\n            <span className='startDate'>\n              {this.dateRender('start')}\n            </span>}\n          {!this.state.info.endDate.includes('--') &&\n            <span className='endDate'>\n              {this.dateRender('end')}\n            </span>}\n        </div>}\n        <div \n          className={`dropArea ${this.state.subtaskDrop ? 'droppable' : ''}`}\n          onDragEnter={() => {\n            console.log(window.draggedTask.props.id);\n            if (window.draggedTask.props.id === this.props.id) return;\n            this.setState({subtaskDrop: true})\n          }}\n          onDragLeave={() => this.setState({subtaskDrop: false})}\n          onDrop={(ev) => this.dropTask(ev, 'subtask')}\n        ></div>\n        <TaskList \n          ref={this.taskList} \n          subtasks={this.state.subtasks}\n          parent={this} \n        />\n      </li>\n      <div \n        className={`dropArea ${this.state.taskDrop ? 'droppable' : ''}\n          ${completed}`}\n        onDragEnter={() => {\n          console.log(window.draggedTask.props.id);\n          if (window.draggedTask.props.id === this.props.id) return;\n          this.setState({taskDrop: true})\n        }}\n        onDragLeave={() => this.setState({taskDrop: false})}\n        onDrop={(ev) => this.dropTask(ev, 'task')}\n        onDragOver={dragOver}\n      ></div>\n      </>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}