{"ast":null,"code":"import*as display from'./display';import*as edit from'./edit';import $ from'jquery';import Task from'../components/Task/Task';import List from'../components/List/List';export function keyComms(ev){if(!ev.ctrlKey){if(ev.key==='Enter'&&!window.preventReturn){ev.preventDefault();if(ev.shiftKey){edit.newTask('task');}else{edit.newTask();}return;}else if(ev.key==='Escape'&&!window.preventReturn){ev.preventDefault();if(window.app.current.state.displayTable!=='none')display.displayTable();document.activeElement.blur();if(window.selected){edit.save(window.selected,'task');if(window.selected instanceof Task&&window.selected.state.displayOptions==='show'){window.selected.displayOptions('hide');}else{window.selected=undefined;}}return;}}if(ev.ctrlKey&&ev.shiftKey){switch(ev.key){case'V':edit.pasteTask('task');break;case'N':edit.newTask('task');break;case'F':ev.preventDefault();display.zoom();break;case'C':// mirror task\nedit.copyTask(true);break;default:break;}}else if(ev.ctrlKey){switch(ev.key){case'x':ev.preventDefault();edit.cutTask();break;case'c':ev.preventDefault();edit.copyTask();break;case'v':ev.preventDefault();edit.pasteTask();break;case'n':ev.preventDefault();edit.newTask();break;case']':ev.preventDefault();edit.indentTask();break;case'[':ev.preventDefault();edit.indentTask(true);break;case'f':ev.preventDefault();display.focus();break;case'z':ev.preventDefault();edit.undo();break;case'r':ev.preventDefault();display.updateAllSizes();break;case'Backspace':ev.preventDefault();if(window.selected&&window.selected instanceof Task){window.selected.deleteThis();}else if(window.selected&&window.selected instanceof List&&window.selected.props.parent.props.id==='bank'){var confirm=window.confirm('delete this list?');if(confirm){var subtasks=window.selected.props.parent.state.subtasks;window.undoData=localStorage.getItem('data');subtasks.splice(subtasks.findIndex(function(x){return x===window.selected.props.id;}),1);window.selected.props.parent.setState({subtasks:subtasks});}}break;case'w':ev.preventDefault();if(window.selected.props.parent.props.id!=='river'){edit.moveTask(-1);}break;case's':ev.preventDefault();if(window.selected.props.parent.props.id!=='river'){edit.moveTask(1);}break;case'a':ev.preventDefault();display.switchView(-1);break;case'd':ev.preventDefault();display.switchView(1);break;case'h':ev.preventDefault();window.app.current.toggleComplete();break;case't':ev.preventDefault();if(window.app.current.state.zoomed==='zoomed')return;display.goToToday();break;case'1':ev.preventDefault();if(window.selected instanceof Task){window.selected.toggleComplete(false);}break;case'2':ev.preventDefault();if(window.selected instanceof Task){window.selected.toggleImportant(false);}break;case'3':ev.preventDefault();if(window.selected instanceof Task){window.selected.toggleMaybe(false);}break;case'i':ev.preventDefault();if(window.selected&&window.selected instanceof Task){window.selected.displayOptions({target:$('<p></p>')});if(window.selected.state.displayOptions==='hide'){window.selected.editBar.current.focus();}};break;default:break;}}}","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/services/keyComms.js"],"names":["display","edit","$","Task","List","keyComms","ev","ctrlKey","key","window","preventReturn","preventDefault","shiftKey","newTask","app","current","state","displayTable","document","activeElement","blur","selected","save","displayOptions","undefined","pasteTask","zoom","copyTask","cutTask","indentTask","focus","undo","updateAllSizes","deleteThis","props","parent","id","confirm","subtasks","undoData","localStorage","getItem","splice","findIndex","x","setState","moveTask","switchView","toggleComplete","zoomed","goToToday","toggleImportant","toggleMaybe","target","editBar"],"mappings":"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","sourcesContent":["import * as display from './display';\nimport * as edit from './edit';\nimport $ from 'jquery';\nimport Task from '../components/Task/Task';\nimport List from '../components/List/List';\n\nexport function keyComms(ev) {\n  if (!ev.ctrlKey) {\n    if (ev.key === 'Enter' && !window.preventReturn) {\n      ev.preventDefault();\n      if (ev.shiftKey) {\n        edit.newTask('task');\n      } else {\n        edit.newTask();\n      }\n      return;\n    } else if (ev.key === 'Escape' && !window.preventReturn) {\n      ev.preventDefault();\n      if (window.app.current.state.displayTable !== 'none') display.displayTable();\n      document.activeElement.blur();\n      if (window.selected) {\n        edit.save(window.selected, 'task');\n        if (window.selected instanceof Task &&\n          window.selected.state.displayOptions === 'show') {\n          window.selected.displayOptions('hide');\n        } else {\n          window.selected = undefined;\n        }\n      }\n      return;\n    }\n  }\n  if (ev.ctrlKey && ev.shiftKey) {\n    switch (ev.key) {\n      case 'V':\n        edit.pasteTask('task');\n        break;\n      case 'N':\n        edit.newTask('task');\n        break;\n      case 'F':\n        ev.preventDefault();\n        display.zoom();\n        break;\n      case 'C':\n        // mirror task\n        edit.copyTask(true);\n        break;\n      default:\n        break;\n    }\n  } else if (ev.ctrlKey) {\n    switch (ev.key) {\n      case 'x':\n        ev.preventDefault();\n        edit.cutTask();\n        break;\n      case 'c':\n        ev.preventDefault();\n        edit.copyTask();\n        break;\n      case 'v':\n        ev.preventDefault();\n        edit.pasteTask();\n        break;\n      case 'n':\n        ev.preventDefault();\n        edit.newTask();\n        break;\n      case ']':\n        ev.preventDefault();\n        edit.indentTask();\n        break;\n      case '[':\n        ev.preventDefault();\n        edit.indentTask(true);\n        break;\n      case 'f':\n        ev.preventDefault();\n        display.focus();\n        break;\n      case 'z':\n        ev.preventDefault();\n        edit.undo();\n        break;\n      case 'r':\n        ev.preventDefault();\n        display.updateAllSizes();\n        break;\n      case 'Backspace':\n        ev.preventDefault();\n        if (window.selected && window.selected instanceof Task) {\n          window.selected.deleteThis();\n        } else if (window.selected && window.selected instanceof List &&\n          window.selected.props.parent.props.id === 'bank') {\n          const confirm = window.confirm('delete this list?');\n          if (confirm) {\n            const subtasks = window.selected.props.parent.state.subtasks;\n            window.undoData = localStorage.getItem('data');\n            subtasks.splice(\n              subtasks.findIndex(x => x === window.selected.props.id), 1);\n            window.selected.props.parent.setState({ subtasks: subtasks });\n          }\n        }\n        break;\n      case 'w':\n        ev.preventDefault();\n        if (window.selected.props.parent.props.id !== 'river') {\n          edit.moveTask(-1);\n        }\n        break;\n      case 's':\n        ev.preventDefault();\n        if (window.selected.props.parent.props.id !== 'river') {\n          edit.moveTask(1);\n        }\n        break;\n      case 'a':\n        ev.preventDefault();\n        display.switchView(-1);\n        break;\n      case 'd':\n        ev.preventDefault();\n        display.switchView(1);\n        break;\n      case 'h':\n        ev.preventDefault();\n        window.app.current.toggleComplete();\n        break;\n      case 't':\n        ev.preventDefault();\n        if (window.app.current.state.zoomed === 'zoomed') return;\n        display.goToToday();\n        break;\n      case '1':\n        ev.preventDefault();\n        if (window.selected instanceof Task) {\n          window.selected.toggleComplete(false);\n        }\n        break;\n      case '2':\n        ev.preventDefault();\n        if (window.selected instanceof Task) {\n          window.selected.toggleImportant(false);\n        }\n        break;\n      case '3':\n        ev.preventDefault();\n        if (window.selected instanceof Task) {\n          window.selected.toggleMaybe(false);\n        }\n        break;\n      case 'i':\n        ev.preventDefault();\n        if (window.selected && window.selected instanceof Task) {\n          window.selected.displayOptions({ target: $('<p></p>') });\n          if (window.selected.state.displayOptions === 'hide') {\n            window.selected.editBar.current.focus();\n          }\n        };\n        break;\n      default:\n        break;\n    }\n  }\n}"]},"metadata":{},"sourceType":"module"}