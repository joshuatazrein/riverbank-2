{"ast":null,"code":"import _objectSpread from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import'./StatusBar.css';import timerSnd from'../../assets/snd/timer.mp3';import startSnd from'../../assets/snd/start.mp3';import*as display from'../../services/display/display';import*as edit from'../../services/edit/edit';import*as util from'../../services/util/util';import*as saving from'../../services/saving/saving';import $ from'jquery';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var StatusBar=/*#__PURE__*/function(_React$Component){_inherits(StatusBar,_React$Component);var _super=_createSuper(StatusBar);function StatusBar(props){var _this;_classCallCheck(this,StatusBar);_this=_super.call(this,props);_this.state={searchString:'',foundTasks:{}};return _this;}_createClass(StatusBar,[{key:\"search\",value:function search(ev){if(this.state.searchString===''){this.searches=_objectSpread({},window.data.tasks);}this.setState({searchString:ev.target.value});for(var _i=0,_Object$keys=Object.keys(this.searches);_i<_Object$keys.length;_i++){var x=_Object$keys[_i];if(!new RegExp(this.state.searchString,'i').test(this.searches[x].title)||this.searches[x].info.complete==='complete'){delete this.searches[x];}}// id : {title, subtasks, info}\nthis.setState({foundTasks:this.searches});}},{key:\"goToSearch\",value:function goToSearch(id){var _this2=this;window.preventReturn=true;window.preventSelect=true;var idList=[id];function buildParents(otherId){for(var _i2=0,_Object$keys2=Object.keys(window.data.tasks);_i2<_Object$keys2.length;_i2++){var x=_Object$keys2[_i2];if(window.data.tasks[util.stripR(x)].subtasks.includes(otherId)){idList.splice(0,0,x);buildParents(x);return;}}}buildParents(id);var frame=window.app.current.state[idList[0]].current;var listIndex=frame.state.subtasks.findIndex(function(x){return x===idList[1];});frame.changeIndex(listIndex,true);setTimeout(function(){var list=frame.frames[0].current;var foundTask=list;var i=2;var _loop=function _loop(){// find in tasks starting at index 2 (if it's there)\nvar taskId=idList[i];var taskIndex=void 0;if(foundTask.subtasksCurrent&&foundTask.subtasksCurrent.length>0){taskIndex=foundTask.subtasksCurrent.findIndex(function(x){return x===taskId;});}else{taskIndex=foundTask.state.subtasks.findIndex(function(x){return x===taskId;});}foundTask=foundTask.taskList.current.subtaskObjects[taskIndex].current;i++;};while(idList.length>i){_loop();}window.preventSelect=false;edit.selectTask(foundTask);_this2.setState({searchString:'',foundTasks:{}});// go through IDs and find the trace paths\nsetTimeout(function(){window.preventReturn=false;},100);},100);}},{key:\"componentDidMount\",value:function componentDidMount(){setTimeout(display.goToToday,200);}},{key:\"goToFirst\",value:function goToFirst(){this.goToSearch($($(this.searchResults.current).children()[0]).attr('value'));}},{key:\"render\",value:function render(){var _this3=this;this.search=this.search.bind(this);this.goToSearch=this.goToSearch.bind(this);this.goToFirst=this.goToFirst.bind(this);this.searchResults=/*#__PURE__*/React.createRef();this.searchBar=/*#__PURE__*/React.createRef();this.options=/*#__PURE__*/React.createRef();this.functions=/*#__PURE__*/React.createRef();this.move=/*#__PURE__*/React.createRef();this.upcoming=/*#__PURE__*/React.createRef();var deadlineItems=Object.keys(this.props.deadlines).filter(function(x){return new Date(x).getTime()>=new Date().getTime();});deadlineItems=deadlineItems.map(function(x){return _this3.props.deadlines[x].map(function(y){return[x,y];});}).flat().filter(function(x){return x.length>0;});this.functionsDict={'newTask':edit.newTask,'cutTask':edit.cutTask,'copyTask':edit.copyTask,'copyTaskTrue':function copyTaskTrue(){return edit.copyTask(true);},'pasteTask':edit.pasteTask,'pasteTaskTask':function pasteTaskTask(){return edit.pasteTask('task');},'deleteTask':edit.deleteTask,'moveTaskUp':function moveTaskUp(){return edit.moveTask(-1);},'moveTaskDown':function moveTaskDown(){return edit.moveTask(1);},'switchView':function switchView(){return display.switchView(1);},'listEditMigrate':function listEditMigrate(){return edit.listEdit('migrate');},'listEditClear':function listEditClear(){return edit.listEdit('clear');},'displayTable':display.displayTable,'focus':display.focus,'zoom':display.zoom,'undo':edit.undo,'toggleComplete':function toggleComplete(){return window.app.current.toggleComplete();},'backup':saving.backup,'restore':saving.restore,'reset':saving.reset,'toggleSounds':display.toggleSounds,'toggleMode':display.toggleMode,'setThemeSpace':function setThemeSpace(){return display.setTheme(\"space\");},'setThemeSky':function setThemeSky(){return display.setTheme(\"sky\");},'setThemeWater':function setThemeWater(){return display.setTheme(\"water\");},'setThemeEarth':function setThemeEarth(){return display.setTheme(\"earth\");},'setThemeFire':function setThemeFire(){return display.setTheme(\"fire\");},'indent':edit.indentTask,'unindent':function unindent(){return edit.indentTask(true);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"statusBar\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"title\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"r\",children:\"River\"}),/*#__PURE__*/_jsx(\"span\",{className:\"b\",children:\"Bank\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',flexDirection:'column',position:'relative'},children:[/*#__PURE__*/_jsx(\"input\",{ref:this.searchBar,className:\"searchBar\",onChange:function onChange(ev){return _this3.search(ev);},value:this.state.searchString,onKeyDown:function onKeyDown(ev){if(ev.key==='Backspace'){ev.preventDefault();_this3.setState({searchString:'',foundTasks:{}});}else if(ev.key==='Enter'){ev.preventDefault();if($(_this3.searchResults.current).children().length>0){_this3.goToFirst();}}},placeholder:\"search\"}),this.state.searchString.length>0&&/*#__PURE__*/_jsx(\"select\",{ref:this.searchResults,style:{width:'5em'},onChange:function onChange(){_this3.goToSearch(_this3.searchResults.current.value);},children:Object.keys(this.state.foundTasks).map(function(x){return/*#__PURE__*/_jsx(\"option\",{value:x,children:_this3.state.foundTasks[x].title},x);})})]}),/*#__PURE__*/_jsx(Timer,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"buttonBar nowrap\",children:[/*#__PURE__*/_jsxs(\"select\",{defaultValue:\"\",ref:this.functions,style:{width:'35px'},onChange:function onChange(){_this3.functionsDict[_this3.functions.current.value].call();_this3.functions.current.value='';},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,hidden:true,children:\"edit\"}),/*#__PURE__*/_jsx(\"option\",{value:\"newTask\",children:\"new task (return)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"cutTask\",children:\"cut (ctrl-x)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"copyTask\",children:\"copy (ctrl-c)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"copyTaskTrue\",children:\"mirror (ctrl-shift-C)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pasteTask\",children:\"paste (ctrl-v)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pasteTaskTask\",children:\"paste as subtask (ctrl-shift-V)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"deleteTask\",children:\"delete (ctrl-delete)\"})]}),/*#__PURE__*/_jsxs(\"select\",{defaultValue:\"\",ref:this.move,style:{width:'45px'},onChange:function onChange(){_this3.functionsDict[_this3.move.current.value].call();_this3.move.current.value='';},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,hidden:true,children:\"move\"}),/*#__PURE__*/_jsx(\"option\",{value:\"moveTaskUp\",children:\"move up (ctrl-w)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"moveTaskDown\",children:\"move down (ctrl-s)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"indent\",children:\"indent (ctrl-])\"}),/*#__PURE__*/_jsx(\"option\",{value:\"unindent\",children:\"unindent (ctrl-[)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"switchView\",children:\"following week/lists (ctrl-d)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"switchView(-1)\",children:\"previous week/lists (ctrl-a)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"listEditMigrate\",children:\"migrate date\"}),/*#__PURE__*/_jsx(\"option\",{value:\"listEditClear\",children:\"clear list\"}),/*#__PURE__*/_jsx(\"option\",{value:\"displayTable\",children:\"display as table\"})]}),/*#__PURE__*/_jsxs(\"select\",{defaultValue:\"\",ref:this.options,onChange:function onChange(){_this3.functionsDict[_this3.options.current.value].call();_this3.options.current.value='';},style:{width:'60px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,hidden:true,children:\"settings\"}),/*#__PURE__*/_jsx(\"option\",{value:\"focus\",children:\"focus on list (ctrl-f)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"zoom\",children:\"focus on view (ctrl-shift-F)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"toggleComplete\",children:\"show/hide complete (ctrl-h)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"undo\",children:\"edit.undo (ctrl-z)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"backup\",children:\"saving.backup\"}),/*#__PURE__*/_jsx(\"option\",{value:\"restore\",children:\"saving.restore\"}),/*#__PURE__*/_jsx(\"option\",{value:\"reset\",children:\"saving.reset\"}),/*#__PURE__*/_jsx(\"option\",{value:\"toggleSounds\",children:\"toggle sounds\"}),/*#__PURE__*/_jsx(\"option\",{value:\"toggleMode\",children:\"toggle day/night\"}),/*#__PURE__*/_jsx(\"option\",{value:\"setThemeSpace\",children:\"theme: space\"}),/*#__PURE__*/_jsx(\"option\",{value:\"setThemeSky\",children:\"theme: sky\"}),/*#__PURE__*/_jsx(\"option\",{value:\"setThemeWater\",children:\"theme: water\"}),/*#__PURE__*/_jsx(\"option\",{value:\"setThemeEarth\",children:\"theme: earth\"}),/*#__PURE__*/_jsx(\"option\",{value:\"setThemeFire\",children:\"theme: fire\"})]}),/*#__PURE__*/_jsx(ListMenu,{}),/*#__PURE__*/_jsxs(\"select\",{defaultValue:\"\",ref:this.upcoming,onChange:function onChange(){_this3.goToSearch(_this3.upcoming.current.value);_this3.upcoming.current.value='';},style:{width:'75px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,hidden:true,children:\"upcoming\"}),deadlineItems.map(function(x){return/*#__PURE__*/_jsxs(\"option\",{value:util.stripR(x[1]),children:[x[0].slice(0,x[0].length-5),\": \",window.data.tasks[util.stripR(x[1])].title]});})]})]})]});}}]);return StatusBar;}(React.Component);export{StatusBar as default};var ListMenu=/*#__PURE__*/function(_React$Component2){_inherits(ListMenu,_React$Component2);var _super2=_createSuper(ListMenu);function ListMenu(props){var _this4;_classCallCheck(this,ListMenu);_this4=_super2.call(this,props);_this4.state={bankLists:props.bankLists,riverLists:props.riverLists};return _this4;}_createClass(ListMenu,[{key:\"goToList\",value:function goToList(type){if(type==='river'){display.searchDate(this.riverLister.current.value);}else if(type==='bank'){var parent=window.app.current.state.bank.current;var list=this.bankLister;parent.changeIndex(Number(list.current.value),true);}if(type==='river'){this.riverLister.current.value='';}else if(type==='bank'){this.bankLister.current.value='';}}},{key:\"render\",value:function render(){var _this5=this;this.riverLister=/*#__PURE__*/React.createRef();this.bankLister=/*#__PURE__*/React.createRef();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"select\",{defaultValue:\"\",ref:this.bankLister,onChange:function onChange(){return _this5.goToList('bank');},style:{width:'35px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,hidden:true,children:\"lists\"}),window.data.tasks['bank'].subtasks.filter(function(x){return window.data.tasks[x].title!=='--';}).map(function(x,index){return/*#__PURE__*/_jsx(\"option\",{value:index,children:window.data.tasks[x].title},x);})]}),/*#__PURE__*/_jsxs(\"select\",{defaultValue:\"\",ref:this.riverLister,onChange:function onChange(){if(_this5.riverLister.current.value==='today'){display.goToToday();_this5.riverLister.current.value='';}else{_this5.goToList('river');}},style:{width:'45px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,hidden:true,children:\"dates\"}),/*#__PURE__*/_jsx(\"option\",{value:\"today\",children:\"today (ctrl-t)\"}),window.data.tasks['river'].subtasks.filter(function(x){return new Date(window.data.tasks[x].title).getTime()>=new Date().getTime();}).map(function(x){return/*#__PURE__*/_jsx(\"option\",{value:window.data.tasks[x].title,children:window.data.tasks[x].title},x);})]})]});}}]);return ListMenu;}(React.Component);var Timer=/*#__PURE__*/function(_React$Component3){_inherits(Timer,_React$Component3);var _super3=_createSuper(Timer);function Timer(props){var _this6;_classCallCheck(this,Timer);_this6=_super3.call(this,props);_this6.state={seconds:0,audio:new Audio(timerSnd),start:new Audio(startSnd),startTime:undefined,ended:false};return _this6;}_createClass(Timer,[{key:\"startTimer\",value:function startTimer(val){var endTime=new Date(new Date().getTime()+val*60*1000).getTime();this.setState({endTime:endTime,seconds:val*60});display.playSound(this.state.start);this.play();}},{key:\"play\",value:function play(stopwatch,backwards){var _this7=this;Notification.requestPermission();clearInterval(this.interval);this.setState({ended:false});if(stopwatch==='stopwatch'){display.playSound(this.state.start);this.interval=setInterval(function(){_this7.setState({seconds:_this7.state.seconds+1});},1000);}else{this.interval=setInterval(function(){_this7.setState({seconds:Math.ceil((_this7.state.endTime-new Date().getTime())/1000)});if(_this7.state.seconds<=0&&_this7.state.ended===false){_this7.end();}},1000);}}},{key:\"end\",value:function end(){this.setState({play:true,ended:true});display.playSound(this.state.audio);this.options.current.value='';new Notification('timer complete');}},{key:\"playPause\",value:function playPause(){clearInterval(this.interval);this.setState({seconds:0});this.options.current.value='';}},{key:\"render\",value:function render(){var _this8=this;this.startTimer=this.startTimer.bind(this);this.playPause=this.playPause.bind(this);this.play=this.play.bind(this);this.audioRef=/*#__PURE__*/React.createRef();this.options=/*#__PURE__*/React.createRef();var timeReadout;if(this.state.seconds>=0){timeReadout=Math.floor(this.state.seconds/60)+':'+String(this.state.seconds-Math.floor(this.state.seconds/60)*60).padStart(2,'0');}else{if(this.state.seconds/60===Math.floor(this.state.seconds/60)&&this.state.seconds!==0){// right on minute\ntimeReadout='-'+-1*Math.floor(this.state.seconds/60)+':00';}else{timeReadout='-'+-1*(Math.floor(this.state.seconds/60)+1)+':'+String(60-(this.state.seconds-Math.floor(this.state.seconds/60)*60)).padStart(2,'0');}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"input\",{className:\"timerBar\",readOnly:true,value:timeReadout}),/*#__PURE__*/_jsxs(\"select\",{value:\"\",ref:this.options,onChange:function onChange(){if(_this8.options.current.value==='clear'){_this8.playPause();_this8.options.current.value='';}else if(_this8.options.current.value==='stopwatch'){_this8.setState({seconds:0});_this8.play('stopwatch');_this8.options.current.value='';}else{_this8.startTimer(_this8.options.current.value);_this8.options.current.value='';}},style:{width:'45px'},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",disabled:true,hidden:true,children:\"timer\"}),/*#__PURE__*/_jsx(\"option\",{value:'clear',children:\"--:--\"}),/*#__PURE__*/_jsx(\"option\",{value:50,children:\"50:00\"}),/*#__PURE__*/_jsx(\"option\",{value:25,children:\"25:00\"}),/*#__PURE__*/_jsx(\"option\",{value:15,children:\"15:00\"}),/*#__PURE__*/_jsx(\"option\",{value:10,children:\"10:00\"}),/*#__PURE__*/_jsx(\"option\",{value:5,children:\"5:00\"}),/*#__PURE__*/_jsx(\"option\",{value:'stopwatch',title:\"stopwatch\",children:\"\\u221E\"})]})]});}}]);return Timer;}(React.Component);","map":{"version":3,"sources":["/Users/frederic/Documents/big-projects/2021-11-01_riverbank-2/riverbank-2/src/components/StatusBar/StatusBar.js"],"names":["React","timerSnd","startSnd","display","edit","util","saving","$","StatusBar","props","state","searchString","foundTasks","ev","searches","window","data","tasks","setState","target","value","Object","keys","x","RegExp","test","title","info","complete","id","preventReturn","preventSelect","idList","buildParents","otherId","stripR","subtasks","includes","splice","frame","app","current","listIndex","findIndex","changeIndex","setTimeout","list","frames","foundTask","i","taskId","taskIndex","subtasksCurrent","length","taskList","subtaskObjects","selectTask","goToToday","goToSearch","searchResults","children","attr","search","bind","goToFirst","createRef","searchBar","options","functions","move","upcoming","deadlineItems","deadlines","filter","Date","getTime","map","y","flat","functionsDict","newTask","cutTask","copyTask","pasteTask","deleteTask","moveTask","switchView","listEdit","displayTable","focus","zoom","undo","toggleComplete","backup","restore","reset","toggleSounds","toggleMode","setTheme","indentTask","flexDirection","position","key","preventDefault","width","call","slice","Component","ListMenu","bankLists","riverLists","type","searchDate","riverLister","parent","bank","bankLister","Number","goToList","index","Timer","seconds","audio","Audio","start","startTime","undefined","ended","val","endTime","playSound","play","stopwatch","backwards","Notification","requestPermission","clearInterval","interval","setInterval","Math","ceil","end","startTimer","playPause","audioRef","timeReadout","floor","String","padStart"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './StatusBar.css';\nimport timerSnd from '../../assets/snd/timer.mp3';\nimport startSnd from '../../assets/snd/start.mp3';\nimport * as display from '../../services/display/display';\nimport * as edit from '../../services/edit/edit';\nimport * as util from '../../services/util/util';\nimport * as saving from '../../services/saving/saving';\nimport $ from 'jquery';\n\nexport default class StatusBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { searchString: '', foundTasks: {} };\n  }\n  search(ev) {\n    if (this.state.searchString === '') {\n      this.searches = { ...window.data.tasks };\n    }\n    this.setState({ searchString: ev.target.value });\n    for (let x of Object.keys(this.searches)) {\n      if (!new RegExp(this.state.searchString, 'i').test(\n        this.searches[x].title) ||\n        this.searches[x].info.complete === 'complete') {\n        delete this.searches[x];\n      }\n    }\n    // id : {title, subtasks, info}\n    this.setState({ foundTasks: this.searches });\n  }\n  goToSearch(id) {\n    window.preventReturn = true;\n    window.preventSelect = true;\n    var idList = [id];\n    function buildParents(otherId) {\n      for (let x of Object.keys(window.data.tasks)) {\n        if (window.data.tasks[util.stripR(x)].subtasks.includes(otherId)) {\n          idList.splice(0, 0, x);\n          buildParents(x);\n          return;\n        }\n      }\n    }\n    buildParents(id);\n    const frame = window.app.current.state[idList[0]].current;\n    const listIndex = frame.state.subtasks.findIndex(x => x === idList[1]);\n    frame.changeIndex(listIndex, true);\n    setTimeout(() => {\n      const list = frame.frames[0].current;\n      let foundTask = list;\n      let i = 2;\n      while (idList.length > i) {\n        // find in tasks starting at index 2 (if it's there)\n        let taskId = idList[i];\n        let taskIndex;\n        if (foundTask.subtasksCurrent &&\n          foundTask.subtasksCurrent.length > 0) {\n          taskIndex = foundTask.subtasksCurrent\n            .findIndex(x => x === taskId);\n        } else {\n          taskIndex = foundTask.state.subtasks\n            .findIndex(x => x === taskId);\n        }\n        foundTask = foundTask.taskList.current\n          .subtaskObjects[taskIndex].current;\n        i++;\n      }\n      window.preventSelect = false;\n      edit.selectTask(foundTask);\n      this.setState({ searchString: '', foundTasks: {} });\n      // go through IDs and find the trace paths\n      setTimeout(() => {\n        window.preventReturn = false;\n      }, 100);\n    }, 100);\n  }\n  componentDidMount() {\n    setTimeout(display.goToToday, 200);\n  }\n  goToFirst() {\n    this.goToSearch($($(this.searchResults.current)\n      .children()[0]).attr('value'));\n  }\n  render() {\n    this.search = this.search.bind(this);\n    this.goToSearch = this.goToSearch.bind(this);\n    this.goToFirst = this.goToFirst.bind(this);\n    this.searchResults = React.createRef();\n    this.searchBar = React.createRef();\n    this.options = React.createRef();\n    this.functions = React.createRef();\n    this.move = React.createRef();\n    this.upcoming = React.createRef();\n    let deadlineItems = Object.keys(this.props.deadlines).filter(\n      x => new Date(x).getTime() >= new Date().getTime()\n    )\n    deadlineItems = deadlineItems.map(x => (\n      this.props.deadlines[x].map(y => [x, y])\n    )).flat().filter(x => x.length > 0);\n    this.functionsDict = {\n      'newTask': edit.newTask,\n      'cutTask': edit.cutTask,\n      'copyTask': edit.copyTask,\n      'copyTaskTrue': () => edit.copyTask(true),\n      'pasteTask': edit.pasteTask,\n      'pasteTaskTask': () => edit.pasteTask('task'),\n      'deleteTask': edit.deleteTask,\n      'moveTaskUp': () => edit.moveTask(-1),\n      'moveTaskDown': () => edit.moveTask(1),\n      'switchView': () => display.switchView(1),\n      'listEditMigrate': () => edit.listEdit('migrate'),\n      'listEditClear': () => edit.listEdit('clear'),\n      'displayTable': display.displayTable,\n      'focus': display.focus,\n      'zoom': display.zoom,\n      'undo': edit.undo,\n      'toggleComplete': () => window.app.current.toggleComplete(),\n      'backup': saving.backup,\n      'restore': saving.restore,\n      'reset': saving.reset,\n      'toggleSounds': display.toggleSounds,\n      'toggleMode': display.toggleMode,\n      'setThemeSpace': () => display.setTheme(\"space\"),\n      'setThemeSky': () => display.setTheme(\"sky\"),\n      'setThemeWater': () => display.setTheme(\"water\"),\n      'setThemeEarth': () => display.setTheme(\"earth\"),\n      'setThemeFire': () => display.setTheme(\"fire\"),\n      'indent': edit.indentTask,\n      'unindent': () => edit.indentTask(true),\n    }\n    return (\n      <div className='statusBar'>\n        <span className='title'><span className='r'>River</span>\n          <span className='b'>Bank</span></span>\n        <div style={{\n          display: 'flex', flexDirection: 'column',\n          position: 'relative'\n        }}>\n          <input\n            ref={this.searchBar}\n            className='searchBar' onChange={(ev) => this.search(ev)}\n            value={this.state.searchString}\n            onKeyDown={(ev) => {\n              if (ev.key === 'Backspace') {\n                ev.preventDefault();\n                this.setState({ searchString: '', foundTasks: {} });\n              } else if (ev.key === 'Enter') {\n                ev.preventDefault();\n                if ($(this.searchResults.current).children().length > 0) {\n                  this.goToFirst();\n                }\n              }\n            }}\n            placeholder='search'></input>\n          {this.state.searchString.length > 0 &&\n            <select ref={this.searchResults}\n              style={{ width: '5em' }}\n              onChange={() => {\n                this.goToSearch(this.searchResults.current.value)\n              }}>\n              {Object.keys(this.state.foundTasks).map(x =>\n                <option key={x} value={x}>\n                  {this.state.foundTasks[x].title}\n                </option>)}\n            </select>\n          }\n        </div>\n        <Timer />\n        <div className='buttonBar nowrap'>\n          <select defaultValue='' ref={this.functions} style={{ width: '35px' }}\n            onChange={() => {\n              this.functionsDict[this.functions.current.value].call();\n              this.functions.current.value = '';\n            }}>\n            <option value=\"\" disabled hidden>edit</option>\n            <option value='newTask'>\n              new task (return)</option>\n            <option value='cutTask'>\n              cut (ctrl-x)</option>\n            <option value='copyTask'>\n              copy (ctrl-c)</option>\n            <option value='copyTaskTrue'>\n              mirror (ctrl-shift-C)</option>\n            <option value='pasteTask'>\n              paste (ctrl-v)</option>\n            <option value='pasteTaskTask'>\n              paste as subtask (ctrl-shift-V)</option>\n            <option value=\"deleteTask\">\n              delete (ctrl-delete)</option>\n          </select>\n          <select defaultValue='' ref={this.move} style={{ width: '45px' }}\n            onChange={() => {\n              this.functionsDict[this.move.current.value].call();\n              this.move.current.value = '';\n            }}>\n            <option value=\"\" disabled hidden>move</option>\n            <option value=\"moveTaskUp\">\n              move up (ctrl-w)</option>\n            <option value=\"moveTaskDown\">\n              move down (ctrl-s)</option>\n            <option value=\"indent\">\n              indent (ctrl-])</option>\n            <option value='unindent'>\n              unindent (ctrl-[)</option>\n            <option value=\"switchView\">\n              following week/lists (ctrl-d)</option>\n            <option value=\"switchView(-1)\">\n              previous week/lists (ctrl-a)</option>\n            <option value=\"listEditMigrate\">\n              migrate date</option>\n            <option value=\"listEditClear\">\n              clear list</option>\n            <option value=\"displayTable\">\n              display as table</option>\n          </select>\n          <select defaultValue='' ref={this.options} onChange={() => {\n            this.functionsDict[this.options.current.value].call();\n            this.options.current.value = '';\n          }}\n            style={{ width: '60px' }}>\n            <option value=\"\" disabled hidden>settings</option>\n            <option value='focus'>focus on list (ctrl-f)</option>\n            <option value='zoom'>focus on view (ctrl-shift-F)</option>\n            <option value='toggleComplete'>\n              show/hide complete (ctrl-h)</option>\n            <option value='undo'>edit.undo (ctrl-z)</option>\n            <option value='backup'>saving.backup</option>\n            <option value='restore'>saving.restore</option>\n            <option value='reset'>saving.reset</option>\n            <option value='toggleSounds'>toggle sounds</option>\n            <option value='toggleMode'>toggle day/night</option>\n            <option value='setThemeSpace'>theme: space</option>\n            <option value='setThemeSky'>theme: sky</option>\n            <option value='setThemeWater'>theme: water</option>\n            <option value='setThemeEarth'>theme: earth</option>\n            <option value='setThemeFire'>theme: fire</option>\n          </select>\n          <ListMenu />\n          <select defaultValue='' ref={this.upcoming} onChange={() => {\n            this.goToSearch(this.upcoming.current.value);\n            this.upcoming.current.value = '';\n          }} style={{width: '75px'}}>\n            <option value=\"\" disabled hidden>upcoming</option>\n            {deadlineItems.map(x => (\n              <option value={util.stripR(x[1])}>\n                {x[0].slice(0, x[0].length - 5)}: {\n                window.data.tasks[util.stripR(x[1])].title}\n              </option>\n            ))}\n          </select>\n        </div>\n      </div>\n    )\n  }\n}\n\nclass ListMenu extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { bankLists: props.bankLists, riverLists: props.riverLists };\n  }\n  goToList(type) {\n    if (type === 'river') {\n      display.searchDate(this.riverLister.current.value);\n    } else if (type === 'bank') {\n      var parent = window.app.current.state.bank.current;\n      var list = this.bankLister;\n      parent.changeIndex(Number(list.current.value), true);\n    }\n\n    if (type === 'river') {\n      this.riverLister.current.value = '';\n    } else if (type === 'bank') {\n      this.bankLister.current.value = '';\n    }\n  }\n  render() {\n    this.riverLister = React.createRef();\n    this.bankLister = React.createRef();\n    return (\n      <>\n        <select defaultValue='' ref={this.bankLister} onChange={() => this.goToList('bank')}\n          style={{ width: '35px' }}>\n          <option value=\"\" disabled hidden>lists</option>\n          {window.data.tasks['bank'].subtasks.filter(\n            x => window.data.tasks[x].title !== '--')\n            .map((x, index) =>\n              <option key={x} value={index}>{window.data.tasks[x].title}</option>)}\n        </select>\n        <select defaultValue='' ref={this.riverLister} onChange={() => {\n          if (this.riverLister.current.value === 'today') {\n            display.goToToday();\n            this.riverLister.current.value = '';\n          } else {\n            this.goToList('river')\n          }\n        }}\n          style={{ width: '45px' }}>\n          <option value=\"\" disabled hidden>dates</option>\n          <option value='today'>today (ctrl-t)</option>\n          {window.data.tasks['river'].subtasks.filter(x => new Date(\n            window.data.tasks[x].title).getTime() >=\n            new Date().getTime())\n            .map((x) =>\n              <option key={x} value={window.data.tasks[x].title}>\n                {window.data.tasks[x].title}</option>)}\n        </select>\n      </>\n    )\n  }\n}\n\nclass Timer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      seconds: 0,\n      audio: new Audio(timerSnd),\n      start: new Audio(startSnd),\n      startTime: undefined,\n      ended: false,\n    };\n\n  }\n  startTimer(val) {\n    const endTime =\n      new Date(new Date().getTime() + val * 60 * 1000).getTime();\n    this.setState({ endTime: endTime, seconds: val * 60 });\n    display.playSound(this.state.start);\n    this.play();\n  }\n  play(stopwatch, backwards) {\n    Notification.requestPermission();\n    clearInterval(this.interval);\n    this.setState({ ended: false });\n    if (stopwatch === 'stopwatch') {\n      display.playSound(this.state.start);\n      this.interval = setInterval(() => {\n        this.setState({ seconds: this.state.seconds + 1 });\n      }, 1000);\n    } else {\n      this.interval = setInterval(() => {\n        this.setState({\n          seconds: Math.ceil((this.state.endTime -\n            new Date().getTime()) / 1000)\n        });\n        if (this.state.seconds <= 0 && this.state.ended === false) {\n          this.end();\n        }\n      }, 1000);\n    }\n  }\n  end() {\n    this.setState({ play: true, ended: true });\n    display.playSound(this.state.audio);\n    this.options.current.value = '';\n    new Notification('timer complete');\n  }\n  playPause() {\n    clearInterval(this.interval);\n    this.setState({ seconds: 0 });\n    this.options.current.value = '';\n  }\n  render() {\n    this.startTimer = this.startTimer.bind(this);\n    this.playPause = this.playPause.bind(this);\n    this.play = this.play.bind(this);\n    this.audioRef = React.createRef();\n    this.options = React.createRef();\n    var timeReadout;\n    if (this.state.seconds >= 0) {\n      timeReadout = Math.floor(this.state.seconds / 60) + ':' +\n        String(this.state.seconds -\n          (Math.floor(this.state.seconds / 60) * 60))\n          .padStart(2, '0')\n    } else {\n      if ((this.state.seconds / 60) === Math.floor(this.state.seconds / 60)\n        && this.state.seconds !== 0) {\n        // right on minute\n        timeReadout = '-' +\n          (-1 * (Math.floor(this.state.seconds / 60))) + ':00'\n      } else {\n        timeReadout = '-' +\n          (-1 * (Math.floor(this.state.seconds / 60) + 1)) + ':' +\n          String(60 - (this.state.seconds -\n            (Math.floor(this.state.seconds / 60) * 60)))\n            .padStart(2, '0')\n      }\n    }\n    return (\n      <>\n        <input className='timerBar' readOnly={true}\n          value={timeReadout}></input>\n        <select value='' ref={this.options} onChange={() => {\n          if (this.options.current.value === 'clear') {\n            this.playPause();\n            this.options.current.value = '';\n          } else if (this.options.current.value === 'stopwatch') {\n            this.setState({ seconds: 0 });\n            this.play('stopwatch');\n            this.options.current.value = '';\n          } else {\n            this.startTimer(this.options.current.value);\n            this.options.current.value = '';\n          }\n        }}\n          style={{ width: '45px' }}>\n          <option value=\"\" disabled hidden>timer</option>\n          <option value={'clear'}>--:--</option>\n          <option value={50}>50:00</option>\n          <option value={25}>25:00</option>\n          <option value={15}>15:00</option>\n          <option value={10}>10:00</option>\n          <option value={5}>5:00</option>\n          <option value={'stopwatch'} title='stopwatch'>&infin;</option>\n        </select>\n      </>\n    )\n  }\n}"]},"metadata":{},"sourceType":"module"}